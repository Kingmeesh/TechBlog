<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>如果不是春天到了</title>
    <link href="/%E5%A6%82%E6%9E%9C%E4%B8%8D%E6%98%AF%E6%98%A5%E5%A4%A9%E5%88%B0%E4%BA%86/"/>
    <url>/%E5%A6%82%E6%9E%9C%E4%B8%8D%E6%98%AF%E6%98%A5%E5%A4%A9%E5%88%B0%E4%BA%86/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div style="text-align: center;"><p>那时我应是在碎梦中欣喜 <br>当远方振翅的蝴蝶痛扑来<br>见你不觉间动容,然后仓皇<br>将脸埋在不被看见的地方<br>    </p><p>如果不是春天到了<br>它的温度就不会这般守约<br>你说多么炽热就多么脆弱<br>恰似当年被判希冀的星光<br></p><p>如果不是春天到了<br>所有主义都将溺毙于潮声<br>谁在香格里拉呼唤<br>不见你深陷这宏爱的战争<br></p><p>如果不是春天到了<br>何以见你身上新造的裂痕<br>你说离开故土啊仆仆风尘<br>怎么忘却花儿此处的芳菲<br></p><p>此刻我已起身信步向阳笑<br>太阳!远方志同道合的朋友<br>常常来到南荒处,为我提携<br>昨夜直踏河流层楼与云月<br>    </p><p>如果春天已经到了<br>不必追究腐败的精确刻度<br>学会用发烂的嘴唇<br>亲吻所有未及降生的晴朗<br>    </p></div>]]></content>
    
    
    <categories>
      
      <category>诗</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>无名诗 1</title>
    <link href="/%E6%97%A0%E5%90%8D%E8%AF%97/"/>
    <url>/%E6%97%A0%E5%90%8D%E8%AF%97/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div style="text-align: center;"><p>当我试图向黑塞和陀氏寻求答案。<br>从炽热的冬天去难以逾越的寒冷<br>也在不合时宜之际将这世界乱爱<br>继而留下了许多热泪盈眶的时刻。<br>    </p><p>当我试图从回望的脚步中去回念。<br>以后来者的视角向世界索求缘由<br>世界却始终沉默，弃我于隔雾观花。<br>可叹爱恨纠葛如人饮水，冷暖自知<br></p><p>我在冷静回望中宣读严厉的判决<br>用镣铐把我和路灯困在寒冷雪夜。<br>我欲暖冷铁，冷铁却欲将我抽离。<br></p><p>我在宏伟叙事中造就爱的自恋者。<br>无有冬天需要逾越，日出或日隐。<br>春日重又会在噼啪声中将我唤醒。<br></p></div><hr><div id="music-player"></div><script>    document.getElementById("music-player").innerHTML = `        <center>            <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="75%" height="86"                    src="https://music.163.com/outchain/player?type=2&id=1843868567&auto=0&height=66">            </iframe>        </center>    `;</script>]]></content>
    
    
    <categories>
      
      <category>诗</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>详解前缀和与差分</title>
    <link href="/%E8%AF%A6%E8%A7%A3%E5%B7%AE%E5%88%86%E4%B8%8E%E5%89%8D%E7%BC%80%E5%92%8C/"/>
    <url>/%E8%AF%A6%E8%A7%A3%E5%B7%AE%E5%88%86%E4%B8%8E%E5%89%8D%E7%BC%80%E5%92%8C/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>前缀和与差分是算法中常用的技巧，主要用于快速处理与区间操作相关的问题。它们各有适用的场景：</p><h3 id="前缀和">前缀和</h3><p><strong>用途</strong>：前缀和用于高效地求解数组中任意区间的元素之和。其思想是预先计算数组的累积和，从而在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>时间内求出任意区间的和。</p><p><strong>解决的问题</strong>：</p><ul><li><strong>区间和查询</strong>：给定一个数组和多个区间，快速求解每个区间的和。</li><li><strong>动态求和问题</strong>：通过提前构建前缀和数组，可以避免重复计算，提高效率。</li></ul><p><strong>更具体的问题</strong>:</p><p>对于一个数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A = [1,5,8,6,2,4,9,7,3]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">]</span></span></span></span>，它的区间是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>9</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,9]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">9</span><span class="mclose">]</span></span></span></span>这意味着第一个数的下标从1开始)，求区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>3</mn><mo separator="true">,</mo><mn>6</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[3,6]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mclose">]</span></span></span></span>的和。</p><p><img src="https://s2.loli.net/2024/11/17/cBoyfwGbh3tANSe.png" alt="数组A"></p><p>求<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>3</mn></mrow><mn>6</mn></msubsup><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\sum_{i=3}^{6}A_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2537em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">3</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，可表示为求</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>6</mn></munderover><msub><mi>A</mi><mi>i</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{6}A_{i} - \sum_{i=1}^{2}A_{i},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0788em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.0788em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></p><p>因为区间是双闭的，我们要确保<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">A_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>不被减去。因此我们定义一个前缀和数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>，令</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><msub><mi>A</mi><mn>1</mn></msub><mo>+</mo><msub><mi>A</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Sum[i] = A_1 + A_2 + ... + A_i,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></p><p>而对于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>中除第一个元素外的所有元素，它们均可表示成</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo>&gt;</mo><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Sum[i] = Sum[i-1] + A_i(i &gt;= 1),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></p><p>这样，通过遍历一次数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，我们就可以得到前缀和数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>:</p><p><img src="https://s2.loli.net/2024/11/17/k4FKVLTSzEUmjtI.png" alt="数组Sum"></p><p>观察数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>，如果我想知道区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>3</mn><mo separator="true">,</mo><mn>6</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[3,6]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mclose">]</span></span></span></span>的和，那么我只需要知道<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mn>6</mn><mo stretchy="false">]</mo><mo>−</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Sum[6] - Sum[2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord">6</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord">2</span><span class="mclose">]</span></span></span></span>是多少就可以了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">A = [<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>]<br>Sum = [<span class="hljs-number">0</span>]  <span class="hljs-comment"># 将0写入Sum的第一个元素</span><br><span class="hljs-comment"># 防止i = 0时访问Sum数组数组越界</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(A)):<br>    Sum.append(Sum[-<span class="hljs-number">1</span>] + A[i])<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;数组A的区间[3,6]求和为:<span class="hljs-subst">&#123;Sum[<span class="hljs-number">6</span>] - Sum[<span class="hljs-number">2</span>]&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>细节处理</strong>：将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>写入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>的第一个元素后，我们会发现<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>数组比<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>数组多了一个元素，这会导致一个问题产生：当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>均从下标1开始计算时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>−</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Sum[j] - Sum[i-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>求的是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>的和，如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>从下标<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>开始，那么计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>−</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Sum[j] - Sum[i-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>求的就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i-1,j-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>的和。</p><p><strong>输出</strong>:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Text">数组A的区间[3,6]求和为:20<br></code></pre></td></tr></table></figure><p><strong>推广</strong>：对于一个数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a = [a_1, a_2, ..., a_n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>，定义前缀和数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span>使得</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">Sum[i] = a_1 + a_2 + ... + a_i.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></p><p>求区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i, j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>的和时，结果可以通过<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>−</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Sum[j] - Sum[i-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>快速得到。</p><h3 id="差分">差分</h3><p><strong>用途</strong>：差分用于高效地进行数组的区间更新操作。通过维护差分数组，可以在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>时间内对数组进行区间加减操作。</p><p><strong>解决的问题</strong>：</p><ul><li><strong>区间增量更新</strong>：快速对一个数组的某个区间内所有元素进行相同的增量或减量操作。</li><li><strong>批量更新问题</strong>：在需要对数组的多个区间进行批量操作时，差分方法可以显著降低复杂度。</li></ul><p><strong>更具体的问题</strong>:</p><p>对于相同的数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A = [1,5,8,6,2,4,9,7,3]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">]</span></span></span></span>，它的区间是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>9</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,9]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">9</span><span class="mclose">]</span></span></span></span>这意味着第一个数的下标从1开始)，现在对数组的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>7</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,3],[2,7],[2,5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mclose">]</span></span></span></span>三个区间分别进行<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mo>+</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">+1,-2,+5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">+</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">+</span><span class="mord">5</span></span></span></span>的操作，求进行加减操作后的数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>。</p><p><img src="https://s2.loli.net/2024/11/17/EqYmUyuGbx1gi8P.png" alt="数组A"></p><p>对数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>进行加减操作，常规的方式是对每一个区间进行遍历，对区间内的每一个元素作相应的处理，然而这种方式的效率很低，有没有一种方式可以实现对每一个区间进行加减操作时，只做常数级的运算呢？</p><p>通过构建数组</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>−</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">(</mo><mi>i</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">D[i] = A[i] - A[i-1](i &gt; 0),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></p><p><img src="https://s2.loli.net/2024/11/17/VfxP3cIH5pahbKC.png" alt="数组D"></p><p>观察数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo separator="true">,</mo><mi>D</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">D,D[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>的含义是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A[i-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>的差值。<strong>在对区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>进行加减操作时，事实上区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[i+1,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>内的任意一个元素与它之前的一个元素之间的差值不会发生改变</strong>，只有第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>个元素与第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>(如果存在)个元素之间的差值和第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>个元素与第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>(如果存在)元素之间的差值(即为该区间每个元素的增减值)会发生变化。也就是说在数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>中，我们只需要修改<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">D[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">D[j+1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>的值，即可更新数组的一次区间修改操作。</p><p>但是我们更新的一直都是数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>，我们需要的一直都是数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>。由数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>如何反推数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>呢？</p><p>由</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>−</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">(</mo><mi>i</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">D[i] = A[i] - A[i-1](i &gt; 0),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></p><p>则有</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>D</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">(</mo><mi>i</mi><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>A</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mi>D</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">A[i] = D[i] + A[i-1](i &gt; 0),A[0] = D[0],</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span></span></p><p>我们会发现实际上<strong>这个过程就是对差分数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>进行一次前缀和</strong>的过程。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">A = [<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>]<br>D = [<span class="hljs-number">0</span>] <span class="hljs-comment"># 将0写入D的第一个元素</span><br>        <span class="hljs-comment"># 防止i = 0时访问D数组数组越界</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(A)):<br>    D.append(A[i] - A[i-<span class="hljs-number">1</span>])<br><br>op = [[<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>],[<span class="hljs-number">2</span>, <span class="hljs-number">7</span>, -<span class="hljs-number">2</span>],[<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>]]<br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> op:<br>    D[_[<span class="hljs-number">0</span>]] += _[<span class="hljs-number">2</span>]<br>    D[_[<span class="hljs-number">1</span>]+<span class="hljs-number">1</span>] -= _[<span class="hljs-number">2</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(A)):<br>    A[i] = D[i+<span class="hljs-number">1</span>] + A[i-<span class="hljs-number">1</span>] <span class="hljs-comment"># 访问差分数组时向后移一位</span><br><span class="hljs-built_in">print</span>(A)<br></code></pre></td></tr></table></figure><p><strong>细节处理</strong>：与前缀和类似，将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>写入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>的第一个元素后，我们会发现<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>数组比<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>数组多了一个元素，这会导致类似的问题产生，同时在对差分数组进行前缀和操作时，需要将差分数组向后移一位。</p><p><strong>输出</strong>:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Text">修改后的A数组为:[2, 9, 12, 9, 5, 2, 7, 7, 3]<br></code></pre></td></tr></table></figure><p><strong>推广</strong>：对于一个初始数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>，构建差分数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>−</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">D[i] = a[i] - a[i-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>（假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a[0] = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>）。要对区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>增加一个值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>，只需执行<code>D[l] += x</code>和<code>D[r+1] -= x</code>。最终的数组可以通过累加差分数组得到。</p><h3 id="两种算法的复杂度分析">两种算法的复杂度分析</h3><table><thead><tr><th><strong>方法</strong></th><th><strong>单次区间和查询</strong></th><th><strong>单次区间更新</strong></th><th><strong>预处理时间</strong></th><th><strong>空间复杂度</strong></th></tr></thead><tbody><tr><td>常规方法</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>前缀和</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td></tr><tr><td>差分</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> (还原)</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></td></tr></tbody></table><ul><li><strong>单次区间和查询</strong>：前缀和最优，能在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 时间内完成；常规方法需要遍历区间，时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。</li><li><strong>单次区间更新</strong>：差分算法最优，能够在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 时间内完成；常规方法和前缀和方法则需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 时间。</li><li><strong>预处理时间</strong>：两种算法都需要一次遍历来构建初始数据结构，时间复杂度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。</li><li><strong>空间复杂度</strong>：两种算法都需要额外的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> 空间来存储辅助数组。</li></ul><p><strong>优缺点总结</strong>:</p><ul><li><strong>前缀和</strong>：适用于频繁的区间和查询，查询效率高；但是在涉及频繁更新时，单次更新需要遍历，效率较低。</li><li><strong>差分</strong>：适合频繁的区间更新，可以在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 时间内处理；但查询区间和时需要恢复原数组，查询效率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。</li><li><strong>常规方法</strong>：不需要额外的存储，但对于大量查询或更新的场景，效率低。</li></ul><h3 id="典型应用">典型应用</h3><ul><li><strong>前缀和</strong>：用于解决问题如“求子数组和”以及“频繁查询区间和”的问题。</li><li><strong>差分</strong>：适用于“区间加减操作”，如“批量增加区间内元素的值”或“更新二维平面上的值”。</li></ul><p>两者都用于优化涉及频繁操作的算法，使之在时间复杂度上更高效。</p><h3 id="再探索：增加一个维度">再探索：增加一个维度</h3><p>在实际应用中，数据不仅限于一维数组。二维数据（如矩阵或图像）在算法和数据处理中的应用也非常广泛。为了快速进行区间查询和更新操作，前缀和与差分这两种技巧可以扩展到二维，从而处理二维数据的区间问题。接下来，我们将详细讲解如何在二维空间中构建和使用前缀和与差分。</p><h4 id="1-二维前缀和">1. 二维前缀和</h4><p><strong>定义</strong>：二维前缀和是一种用于快速查询矩阵中任意子矩形区域元素之和的数据结构。它通过构建累积和矩阵，使得查询操作的时间复杂度降低到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p><p><strong>构建方法</strong>：对于一个二维矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> 大小为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>，定义二维前缀和矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span></span></span></span> 使得：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></munderover><munderover><mo>∑</mo><mrow><mi>y</mi><mo>=</mo><mn>1</mn></mrow><mi>j</mi></munderover><mi>A</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Sum[i][j] = \sum_{x=1}^{i} \sum_{y=1}^{j} A[x][y],</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.262em;vertical-align:-1.4032em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8117em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8588em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3471em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4032em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span></span></p><p>即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Sum[i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> 表示从矩阵左上角$ (1, 1) $到位置 $(i,j) $的子矩阵中所有元素的累加和。</p><p><strong>递推公式</strong>：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>−</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">Sum[i][j] = A[i][j] + Sum[i-1][j] + Sum[i][j-1] - Sum[i-1][j-1],</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span></span></p><p>该公式中，减去 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Sum[i-1][j-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 是为了消除重复累加的部分。</p><p><strong>查询方法</strong>：要查询矩阵中任意子矩形区域<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>的和，可以通过以下公式快速得到：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Result</mtext><mo>=</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo>−</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo>−</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>S</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\text{Result} = Sum[x_2][y_2] - Sum[x_1-1][y_2] - Sum[x_2][y_1-1] + Sum[x_1-1][y_1-1],</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Result</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span></span></p><p>这里需要注意边界条件，即当 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 或 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 等于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 时，减去的部分可能不存在。</p><p><strong>代码实现</strong>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 假设我们有一个 m x n 的矩阵 A</span><br>A = [<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],<br>    [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],<br>    [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]<br>]<br><br><span class="hljs-comment"># 构建二维前缀和矩阵</span><br>m, n = <span class="hljs-built_in">len</span>(A), <span class="hljs-built_in">len</span>(A[<span class="hljs-number">0</span>])<br>Sum = [[<span class="hljs-number">0</span>] * (n + <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m + <span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>        Sum[i][j] = A[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>] + Sum[i-<span class="hljs-number">1</span>][j] + Sum[i][j-<span class="hljs-number">1</span>] - Sum[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>]<br><br><span class="hljs-comment"># 查询子矩形 (2, 2) 到 (3, 3)</span><br>x1, y1, x2, y2 = <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span><br>result = Sum[x2][y2] - Sum[x1-<span class="hljs-number">1</span>][y2] - Sum[x2][y1-<span class="hljs-number">1</span>] + Sum[x1-<span class="hljs-number">1</span>][y1-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;查询区域和为: <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>复杂度分析</strong>：</p><ul><li><strong>预处理时间</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m \times n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li><li><strong>查询时间</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><strong>空间复杂度</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m \times n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li></ul><h4 id="2-二维差分">2. 二维差分</h4><p><strong>定义</strong>：二维差分扩展了一维差分的思想，适用于在二维矩阵中进行快速区间更新操作。通过构建差分矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>，可以在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 时间内更新矩阵的任意子矩形区域。</p><p><strong>构建方法</strong>：对于给定的矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>，定义二维差分矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> 为：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>−</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>−</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">D[i][j] = A[i][j] - A[i-1][j] - A[i][j-1] + A[i-1][j-1],</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span></span></span></span></span></p><p>这个矩阵记录了位置<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>及其邻近位置的差异。</p><p><strong>区间更新方法</strong>：为了在矩阵的子矩形区域<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_1, y_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_2, y_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 中增加一个值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>，需要在差分矩阵中进行以下操作：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo>+</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">D[x_1][y_1] += k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>−</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">D[x_1][y_2 + 1] -= k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>（如果存在）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo>−</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">D[x_2 + 1][y_1] -= k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>（如果存在）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo stretchy="false">[</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">D[x_2 + 1][y_2 + 1] += k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>（如果存在）</li></ul><p><strong>更新后的矩阵恢复</strong>：构建完差分矩阵并进行更新后，通过对差分矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> 进行二维前缀和操作可还原出最终的矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>。</p><p><strong>代码实现</strong>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 初始化矩阵大小</span><br>m, n = <span class="hljs-number">3</span>, <span class="hljs-number">3</span><br><br><span class="hljs-comment"># 初始化差分矩阵 D，大小为 (m+2) x (n+2)</span><br>D = [[<span class="hljs-number">0</span>] * (n + <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">2</span>)]<br><br><span class="hljs-comment"># 执行一次区间更新，增加 k</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">x1, y1, x2, y2, k</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    对矩形区域 (x1, y1) 到 (x2, y2) 增加 k</span><br><span class="hljs-string">    x1, y1, x2, y2 坐标基于 1 开始</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    D[x1][y1] += k<br>    <span class="hljs-keyword">if</span> y2 + <span class="hljs-number">1</span> &lt;= n + <span class="hljs-number">1</span>:<br>        D[x1][y2 + <span class="hljs-number">1</span>] -= k<br>    <span class="hljs-keyword">if</span> x2 + <span class="hljs-number">1</span> &lt;= m + <span class="hljs-number">1</span>:<br>        D[x2 + <span class="hljs-number">1</span>][y1] -= k<br>    <span class="hljs-keyword">if</span> x2 + <span class="hljs-number">1</span> &lt;= m + <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> y2 + <span class="hljs-number">1</span> &lt;= n + <span class="hljs-number">1</span>:<br>        D[x2 + <span class="hljs-number">1</span>][y2 + <span class="hljs-number">1</span>] += k<br><br><span class="hljs-comment"># 示例：执行几次区间更新</span><br>update(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>)  <span class="hljs-comment"># 矩形 (1, 1) 到 (2, 2) 增加 5</span><br>update(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>) <span class="hljs-comment"># 矩形 (2, 2) 到 (3, 3) 增加 10</span><br>update(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>)  <span class="hljs-comment"># 矩形 (1, 3) 到 (3, 3) 增加 3</span><br><br><span class="hljs-comment"># 对二维差分矩阵进行前缀和，得到最终的矩阵 D</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m + <span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>        D[i][j] += D[i-<span class="hljs-number">1</span>][j] + D[i][j-<span class="hljs-number">1</span>] - D[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>]<br><br><span class="hljs-comment"># 恢复最终矩阵 A</span><br>A = [[<span class="hljs-number">0</span>] * n <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m)]  <span class="hljs-comment"># 初始化矩阵 A</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, m + <span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, n + <span class="hljs-number">1</span>):<br>        A[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>] = D[i][j]<br><br><span class="hljs-comment"># 输出结果</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> A:<br>    <span class="hljs-built_in">print</span>(row)<br></code></pre></td></tr></table></figure><p><strong>复杂度分析</strong>：</p><ul><li><strong>预处理时间</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>（只需初始化）</li><li><strong>更新时间</strong>：单次更新为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><strong>还原时间</strong>：二维前缀和计算的时间为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m \times n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li><li><strong>空间复杂度</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>×</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(m \times n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li></ul><h4 id="3-应用场景和总结">3. 应用场景和总结</h4><ul><li><strong>二维前缀和</strong>适用于快速查询任意子矩形的元素和，如图像处理、地图数据查询等。</li><li><strong>二维差分</strong>非常适合对矩阵中进行多次批量区间更新，如对地图上多个区域施加增量操作或处理动态累计更新的问题。</li></ul><p>通过扩展到二维，这两种算法继续发挥其高效处理区间问题的优势，为复杂的数据结构提供更好的解决方案。</p><h3 id="例题：棋盘">例题：棋盘</h3><p>小蓝拥有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n×n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>大小的棋盘，一开始棋盘上全都是白子。</p><p>小蓝进行了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>次操作，每次操作会将棋盘上某个范围内的所有棋子的颜色取反(也就是白色棋子变为黑色，黑色棋子变为白色)。</p><p>请输出所有操作做完后棋盘上每个棋子的颜色。</p><h4 id="输入格式">输入格式</h4><p>输入的第一行包含两个整数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n,m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span></span></span></span>，用一个空格分隔，表示棋盘大小与操作数。</p><p>接下来<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>行每行包含四个整数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_1,y_1,x_2,y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，相邻整数之间使用一个空格分隔，表示将在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>至<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>行和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>至<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>列中的棋子颜色取反。</p><h4 id="输出格式">输出格式</h4><p>输出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>行，每行<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>或<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>表示该位置棋子的颜色。</p><p>如果是白色则输出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，否则输出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。</p><h4 id="数据范围">数据范围</h4><p>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">30\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">30%</span></span></span></span> 的评测用例，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>≤</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">1≤n,m≤500</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">500</span></span></span></span>；<br>对于所有评测用例，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>≤</mo><mn>2000</mn><mo separator="true">,</mo><mo>≤</mo><msub><mi>x</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mi>n</mi><mo separator="true">,</mo><mn>1</mn><mo>≤</mo><msub><mi>y</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>y</mi><mn>2</mn></msub><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1≤n,m≤2000, \le x_1 \le x_2 \le n, 1≤y_1≤y_2≤n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2000</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>。</p><h4 id="输入样例：">输入样例：</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Text">3 3<br>1 1 2 2<br>2 2 3 3<br>1 1 3 3<br></code></pre></td></tr></table></figure><h4 id="输出样例：">输出样例：</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Text">001<br>010<br>100<br></code></pre></td></tr></table></figure><h4 id="代码：">代码：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python">n, m = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><br>arr = [[<span class="hljs-number">0</span>] * n <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>diff = [[<span class="hljs-number">0</span>] * n <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br><br><span class="hljs-comment"># 定义一个用于更新差分数组的函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">change</span>(<span class="hljs-params">diff, op</span>):<br>    x1, y1, x2, y2 = op<br><br>    <span class="hljs-comment"># 将输入的坐标转换为0-indexed</span><br>    x1 -= <span class="hljs-number">1</span><br>    y1 -= <span class="hljs-number">1</span><br>    x2 -= <span class="hljs-number">1</span><br>    y2 -= <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># 在差分数组中进行更新</span><br>    diff[x1][y1] += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> x2 + <span class="hljs-number">1</span> &lt; n:<br>        diff[x2 + <span class="hljs-number">1</span>][y1] -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> y2 + <span class="hljs-number">1</span> &lt; n:<br>        diff[x1][y2 + <span class="hljs-number">1</span>] -= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> x2 + <span class="hljs-number">1</span> &lt; n <span class="hljs-keyword">and</span> y2 + <span class="hljs-number">1</span> &lt; n:<br>        diff[x2 + <span class="hljs-number">1</span>][y2 + <span class="hljs-number">1</span>] += <span class="hljs-number">1</span><br><br><span class="hljs-comment"># 读取每次操作并存储</span><br>oparr = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    oparr.append(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())))<br><br><span class="hljs-comment"># 根据差分数组来计算实际棋盘的状态</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-comment"># 使用差分数组来计算每个位置的累计值</span><br>        diff[i][j] = (arr[i][j]<br>                      + (arr[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] <span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> j &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>)<br>                      - (arr[i][j - <span class="hljs-number">1</span>] <span class="hljs-keyword">if</span> j &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>)<br>                      - (arr[i - <span class="hljs-number">1</span>][j] <span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>))<br><br><span class="hljs-comment"># 处理所有操作</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    change(diff, oparr[i])<br><br><span class="hljs-comment"># 最终根据差分数组的值更新棋盘的状态</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-comment"># 计算当前坐标的状态，统一处理</span><br>        <span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">0</span>:<br>            arr[i][j] += arr[i-<span class="hljs-number">1</span>][j]  <span class="hljs-comment"># 累加上一行的值</span><br>        <span class="hljs-keyword">if</span> j &gt; <span class="hljs-number">0</span>:<br>            arr[i][j] += arr[i][j-<span class="hljs-number">1</span>]  <span class="hljs-comment"># 累加前一列的值</span><br>        <span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> j &gt; <span class="hljs-number">0</span>:<br>            arr[i][j] -= arr[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>]  <span class="hljs-comment"># 减去重复计算的左上角的值</span><br>        arr[i][j] = (arr[i][j] + diff[i][j]) % <span class="hljs-number">2</span>  <span class="hljs-comment"># 最终加上差分值并取模</span><br><br><span class="hljs-comment"># 输出最终的棋盘状态</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, arr[i])))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>算法</category>
      
    </categories>
    
    
    <tags>
      
      <tag>差分</tag>
      
      <tag>前缀和</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>死便埋我(一)</title>
    <link href="/%E6%AD%BB%E4%BE%BF%E5%9F%8B%E6%88%91(%E4%B8%80)/"/>
    <url>/%E6%AD%BB%E4%BE%BF%E5%9F%8B%E6%88%91(%E4%B8%80)/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>夜里，他走在满是小石子的道路上，路旁是遍地预备重生的野草，两侧则是初春寒冷的田野。对刘伶来说，家乡是一处南荒之地，在这里，人们严格遵照自然的作息，夜是安静的夜，暗也暗得纯粹。只有同样出门在外的卡车不时从他身旁路过，为这位刚刚开始自己漂泊之旅的孩子带来满身尘土。然而说实在的，刘伶并不因此有何懈怠和恐惧，毕竟对于一个内心拥有持久且强烈的冲动的人来说，行动受限于各种鸡毛蒜皮之事，似乎比承受因顺从内心抉择而面临的一切磨难都要痛苦得多。一直以来，周围的许多长辈仍不假思索地用一种先生视角，常常以一种傲慢的姿态教导这个内心成熟的少年。正如他自己在所写的文字中描述的那样，多年来他陷入了苦闷和孤独，我们可怜的主人公因此常常被困在一种严肃和拘谨的状态之中，却没有任何一个“先生”能够注意到这个落寞的少年，他们不但无法投以同情和理解的目光，还激情洋溢地说：“青年人应该朝气蓬勃，而不是你这样的死气沉沉！”一旦他将长辈们反叛，他们首先以一种自认为宽慰与和蔼的姿态说：“你也不小了，该懂点事了”，在说完这些之后，他们必须补充道：“现在好好和你说不要不听，别惹我发火。”在刘伶看来，长辈们虚伪的亲和下是无端的期待、强势的话术和无用的建议。为了显得稳重成熟，他只能更加地严肃和拘谨，可事实上连他也不清楚，孤独和不被理解哪个先将他侵占。</p><p>对于每一个开始自己人生中第一次漂泊之旅的孩子来说，旅程是艰辛且幸福的。此刻的刘伶惬意放松，对未来满怀期待的喜悦心情让他的步伐变得更加俏皮，他走两步就转上一圈，月光默默助长他跳动的欲望。在夜晚微风的吹拂中，他逐渐解开长久以来无形的束缚，轻盈的脚步跳起轻松欢快的舞。这是他在夜里常常幻想的自由的舞动，舞蹈能够带给他一种尽情绽放生命的享受，当他张开双臂扭动身体，感受到了许久未见的孩童般的自由。</p><p>第二天黎明来临之际，他已经走在了五二〇乡道上。乡道，顾名思义，两侧都是乡野。经过一夜的漂泊，刘伶已经疲倦不堪，瘦弱的青年早已将世界抛之脑后，不复昨夜的轻快。在太阳完全探出地平线的时候，他终于停在了一颗百年樟树的下面。他的背包里除了随身的几本小册子，还有一袋牛肉干和几块桃酥饼。阮籍悄悄从大树的背后绕过，饥肠辘辘的他刻意上前搭话。</p><p>“小兄弟，你知道‘Only pay 1’酒吧怎么走么？”他微笑着一边问话，一边暗中观察这个气色稍差的小伙子，感到一种莫名的亲切。</p><p>刘伶急忙吞下口中干粮，“我没有手机，抱歉”，接着对眼前陌生人的微笑感到诧异。</p><p>“嘿，奇怪了，难道你没了手机都不认路吗？”他说着便自然地坐下。</p><p>刘伶脸色淡然，只摇摇头说：“倒也不是。”阮籍似乎还等待着对方解释什么，随后空气静默了六秒钟，他从口袋里掏出一张地图，问：“小兄弟，看你样子也不是这地方的，准备去哪？”</p><p>“没有目的地。哪里有自然，我就去哪里。 ”</p><p>“自然？离群索居？”阮籍察言观色，对方似乎并无回答之意，于是接着讲道：“然而却并无什么大不了的，哪里不算是自然呢？有人说自然是不受人类干预的那一部分，可那一定是假话！你想要亲近自然，即便只是远远地看着，也是对自然的干预，说白了是自然首先存在，而如果你热爱自然，这一定是你自私的想法，毕竟自然它并不企求你的热爱。如果你深深地热爱自然是因为它给你带来了宁静和自由的感觉，那倒不如说你在宁静和自由中更能感受到生命的意义，然而前提终究是你在感受。如今你说自然在哪里你就去哪里，可见你并不真正了解自然，也许你赋予了自然过多的价值，如果你接触到了你所认为的真正的自然，无疑你会失望的。”</p><p>“你想法蛮多，却无知而狂妄！我本就不愿与你交谈，在我看来与人交谈简直毫无意义，你既不能给我带来任何富有洞见的观点，有时我费劲口舌最终也只是对牛弹琴！一边跟我东扯西扯一边饿狼般地望着我的桃酥饼，你来要饭就直说，何必兜圈子？”为了表现自己的愤怒，在递送桃酥饼的时候刘伶刻意加重了气力。</p><p>阮籍脸色略显尴尬，说：“谢谢！你说的对，可并不是做什么事情都需要富有价值的回报。不过谢谢你的桃酥饼，还有你的坦率。”</p><p>于是在一种针锋相对的微妙氛围中，两人默默无言地吃完饼，阮籍先行一步告了别。</p>]]></content>
    
    
    <categories>
      
      <category>小说</category>
      
    </categories>
    
    
    <tags>
      
      <tag>死便埋我</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>“重建附近”：年轻人如何从现实中获得力量？</title>
    <link href="/%E2%80%9C%E9%87%8D%E5%BB%BA%E9%99%84%E8%BF%91%E2%80%9D%EF%BC%9A%E5%B9%B4%E8%BD%BB%E4%BA%BA%E5%A6%82%E4%BD%95%E4%BB%8E%E7%8E%B0%E5%AE%9E%E4%B8%AD%E8%8E%B7%E5%BE%97%E5%8A%9B%E9%87%8F%EF%BC%9F/"/>
    <url>/%E2%80%9C%E9%87%8D%E5%BB%BA%E9%99%84%E8%BF%91%E2%80%9D%EF%BC%9A%E5%B9%B4%E8%BD%BB%E4%BA%BA%E5%A6%82%E4%BD%95%E4%BB%8E%E7%8E%B0%E5%AE%9E%E4%B8%AD%E8%8E%B7%E5%BE%97%E5%8A%9B%E9%87%8F%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="摘要-sup-id-fnref-1-class-footnote-ref-a-href-fn-1-rel-footnote-span-class-hint-top-hint-rounded-aria-label-本文内容来自《当代青年研究》2023年11月第-5-https-qing-cbpt-cnki-net-wkh-WebPublication-paperDigest-aspx-paperID-e4e7eee0-a359-4f9a-9496-612b13ac9ba8-、第-6-https-qing-cbpt-cnki-net-wkh-WebPublication-paperDigest-aspx-paperID-7565cf64-374f-4372-a52e-1889a6ca3ac8-期。-1-span-a-sup">摘要<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="本文内容来自《当代青年研究》2023年11月第[5](https://qing.cbpt.cnki.net/wkh/WebPublication/paperDigest.aspx?paperID=e4e7eee0-a359-4f9a-9496-612b13ac9ba8)、第[6](https://qing.cbpt.cnki.net/wkh/WebPublication/paperDigest.aspx?paperID=7565cf64-374f-4372-a52e-1889a6ca3ac8)期。">[1]</span></a></sup></h3><p>人类学家项飙提出“附近”的概念，尤其将“重建附近”作为对当下年轻人的一种劝说。《当代青年研究》近日对项飙进行专访，访谈分为上、下两篇发布，上篇访谈讨论了“附近”作为一个概念的缘起、背景、价值和所能扮演的角色。项飙认为，“附近”的概念受到存在主义和实用主义哲学的影响，旨在发展一种“生活的人类学”，希望能使个体在无法改变整体性环境的条件下学会如何处理自己的生活，而“附近”正是解决这一难题的现实的、小的突破口。通过对退出与逃避、生态与功能、“大”与“小”等几对关系的讨论，“附近”希望倡导一种态度，即用生态性的视角重新认识周边和安顿自身，从而能更好地欣赏和理解社会的差异性，以及这种差异性存在的合理性，从中看到它的价值，帮助年轻人可以勇敢地、智慧地为今天看似失控的生活重新找到一个“锚”。项飙访谈下篇从当下年轻人的精神文化现象和社群结构特点切入，具体地分析年轻人在现实中所遭遇的问题，以及“附近”可以在其中发挥的作用。项飙认为，二次元文化的强大是年轻人对现实的一种逃避，如何真正走向三次元的生活对今天的年轻人是一个重大挑战，社会科学需要发展出一套话语，来培养年轻人直面现实的意识，使他们从现实的矛盾和“不舒服”中看到意义和价值，而“附近”所强调的生态性视角可能成为调动这种意识的力量。项飙强调，沉溺于虚拟世界的原子化生存方式强化了社会同化的趋势，使自我变得虚幻和脆弱。近年来，“心理健康热”的流行恰恰反映了年轻人对自身困境强烈的问题意识，“附近”概念引起大众兴趣正是个体对自己在这个世界上的存在方式和存在意义的追问和反思。同时，代际关系和性别关系在“附近”建设中，既是一种重要的资源，也是一种压迫性力量。</p><h3 id="人物介绍"><strong>人物介绍</strong></h3><p><strong>项飙</strong>，德国马克斯·普朗克社会人类学研究所所长，英国牛津大学社会人类学教授。作为人类学家，项飙早年因浙江村的调研而成名，其后赴海外求学并在澳洲、东南亚等地开展海外民族志研究。他长期致力于人口迁移和流动、劳动力市场、跨国再生产等领域的研究，通过移民的视角，他的研究涉及广泛的政治经济学议题，包括国家与社会的关系、劳动、社会再生产和流动性治理等。他的著作<em>Global</em>“<em>Body Shopping</em>”获得2008年Anthony Leeds奖，论文<em>Predatory Princes and Princely Peddlers</em>获得2012年William L. Holland奖，2000年出版的中文著作《跨越边界的社区》（2005年英文版）于2018年作为社会人类学的当代经典重印。他的中文作品《把自己作为方法》《中国社会科学“知青时代”的终结》《中国人像蜂鸟，振动翅膀悬在空中》等在中国读者中引起强烈而持续的反响。他的作品被翻译成日语、法语、韩语、西班牙语和意大利语。</p><p><strong>康岚</strong>，《当代青年研究》编委，责任编辑。</p><p>近年来，项飙成为一位频频将学术概念转换成公共话语的人类学家。他认为，21世纪的社会科学研究一定要是对话式的，那种话语操作式的理论生产，跟大众的感受对不上号；在今天，学问做得好，一定要寻找一种效果，你可能给不了具体答案，但要对人们寻找答案提供帮助（王竞，2022）。</p><p>项飙一直对中国年轻人的焦虑比较敏感，他希望能把年轻人心头的痛点解读出来，能回应年轻人的焦虑感这类常识性问题。同时，生活中的问题又是一团乱麻，怎样从大众的现实感受出发，把经验中模糊不清、相互缠绕的问题清晰化，跳出将生活按学术领域进行切割的思维，形成对生活整体的、有效的思维方式和思考角度，是项飙正在探索的一种新的研究方法，他称之为“共同的焦虑”（Common Concerns Approach，参见：Xiang，2022）。为此，他频繁参与公共讨论，与不同群体展开对话，希望更加直接地介入社会与生活中去。</p><p>这种把自己作为方法、把痛点作为方法、把对话作为方法的研究尝试，在讨论今天年轻人的问题时到底会产生怎样的效果？带着这样的疑问，《当代青年研究》对项飙进行了独家专访。访谈从引起广泛关注的“附近”概念开始，讨论了今天年轻人理解生活的基础、对大环境的无力感和失控感，以及他们的应对方式和后果，并进一步深入今天年轻人的精神状况、现实感、心理健康等问题。本期刊登访谈的上篇，主要涉及以下问题：（1）今天，人们理解世界和生活的方式发生了怎样的变化？（2）为什么浸淫到具体的“附近”中，可以对抗生活的失控感和无力感？（3）面对不利的生存环境时，退出和逃离的区别是什么？怎样的选择是勇敢和有力量的？（4）为什么要用生态性的态度去看待身边的环境和自己的选择？（5）为什么要从具体的个人经历的角度去分析宏大的主题？（6）今天的社会，为什么抱怨和维护都这么激烈？出路在哪？或者说，在大环境给定的条件下，普通人如何通过周边的小环境来保持自己思考和行动的能力？</p><h3 id="一、“附近的消失”：我们建立对世界的感知，越来越通过一些抽象的概念和原则，而身边的“具体性”不再成为我们理解生活的基础"><strong>一、“附近的消失”：我们建立对世界的感知，越来越通过一些抽象的概念和原则，而身边的“具体性”不再成为我们理解生活的基础</strong></h3><p><strong>康岚</strong>：您最早在什么时候提出“附近”这个概念？为什么想到提出这个概念？</p><p><strong>项飙</strong>：其实这个概念的提出，并没有一个事先的设想，它是一个逐步发展的过程。这个逐步发展的过程也不是我自己在那里观察思考，更多的是一个互动，很大程度上是别人推着我往前想；这个别人是指社会学界、人类学界的同行们，但是远比学术界重要的是大众、是青年朋友们通过社交网络上的讨论来推着我。我一开始完全没有想到这个概念会有这样的影响，所以现在需要回头看，为什么它会有这样的效果出来。所以你的问题很好：它的缘起在哪里？</p><p>我第一次提“附近”应该是在2019年夏天，我跟许知远在“十三邀”节目上的对话。当时好像是在谈现代人的时空观念，为什么现在人们对快递小哥迟到两分钟会非常不耐烦，我们说到现代生活完全是被时间逻辑统治了，空间逻辑消失了。原来我们对时间的理解是通过人的行动，比方说我和你的距离是一袋烟的工夫，或者说这个距离是从你们家走到荷塘边上的那个工夫，其实时间很大程度上是通过空间来衡量的。但是在工业化之后，抽象时间，也就是钟表时间变得非常重要（这个当然不是我的发明，大家都这么说过）。而现在又有了数字化科技，比如超高频金融贸易就是一个时间游戏，它赚钱的方式就是我要比别人快半秒，依靠极高速、高频次地买进卖出来赚钱。当这种抽象时间统治了我们的生活，空间就完全变成了附属性的东西。对快递小哥迟到两分钟会非常不满，是因为你根本不考虑他是从空间中哪个点到餐馆拿了东西，以及路上的交通是怎样的、进你家小区的门时他要跟保安怎样交涉，这些经历性、空间性的东西，以及这一切是如何在空间中展开的，你是不管的，你要的就是那个东西要在你规定的时间内送到你的手里。所以这是一种“去空间”的或者说“时间的暴政”吧。我是在这样的场景下，提到“附近的消失”。</p><p>“附近”这个空间的消失，一方面是因为“时间的暴政”，另一方面是因为我们在日常生活里面建立自己对世界的感知越来越通过一些抽象的概念和原则，而不是通过对自己周边的感知来理解。比如，你的邻居是干什么的，楼下打扫卫生的人是从哪里来的，他们家在哪里，如果家不在这里，一年回几次家，他们的焦虑和梦想是什么，门口卖水果的、下午四点钟来卖菜的那些人都是谁。这些人对你的生活很重要，但是他们不会被允许进入小区，把他们挡在小区外面的是保安，保安跟这些人又是一样的人。这些就是“附近”。因为我们的日常生活就是由他们来组织的，没有他们，我们的生活不能够正常运行。但是，我们对这些“附近”经常是视而不见的。</p><p>这个“附近”，它是一个空间，它的有趣在于它有很强的社会性，它是你这个社会主体的物质基础，把你托起来。在这里面，有很多很细密的又很复杂的、看似好像不重要的但其实是很重要的各种各样的社会关系。</p><p>所以最早提出“附近”的起点可能是两点，一个是对中国社会生活怎么被时间焦虑组织起来的一个反应，另一个就是对大家如何理解生活的认知，就是“附近”消失了。所以我提出，要关注“附近”，一方面来重构自己的生活，从“时间的暴政”中解放出来；另一方面在主观意识上，重新树立一种理解世界和生活的方式。最早就是这么提出来的，当时就是一个描述性的，但有它的针对性；后来大家觉得“附近”值得讨论，我想是因为确实觉得有针对性。</p><h3 id="二、“附近”是年轻人面对失控的生活时，可以为生活重新找到的一个“锚”"><strong>二、“附近”是年轻人面对失控的生活时，可以为生活重新找到的一个“锚”</strong></h3><p><strong>康岚</strong>：您说过，“重建附近”不是一种论述，而是一种劝说，尤其是对年轻人的劝说，为什么“附近”对年轻人尤其重要？</p><p><strong>项飙</strong>：当时我好像还提到，年轻人关心的就是两极。一方面他们非常关注自我，比如考试、毕业以后去哪里等，对这些问题的焦虑是很大的；但另一方面，通过社交媒体，他们又非常关心远方，比如全球的一些危机、民族的兴盛啊，这些宏大叙事造成了社交媒体上各种辩论中情绪上的很大波动。情绪波动是因为这些宏大叙事是通过各种抽象的说法来形成的，但是人们对自己周边的生活究竟是怎么样的，认知反而是很模糊的。</p><p>我（在牛津教书的时候）问来自中国的学生，你父母是干什么的，你从小是怎么回事，你亲戚是怎么回事，你大学里的老师这么教、那么教的原因在哪里，教师的激励机制是怎么样的，很少有人能够讲清楚。很多年轻人对自己的整个生活是怎么被编织起来的、这一路走过来是怎么回事，是讲不清楚的，但他可以给你讲很多概念和大的理论。我觉得，<strong>如果一个人对身边的事情都讲不清楚，那他讲远方的事情肯定也讲不出什么意思来，因为他缺乏对人的经验进行洞察的能力</strong>，他讲来讲去都是书面上的词语。所以我感到非常失望。从一个教师的角度，我觉得，学生不懂得“附近”，也就不可能懂得世界。</p><p>我在想，“附近”这个概念为什么后来会引起反响，比较重要的原因是它点出了一个症结，我当时没有意识到，就是很多年轻人觉得自己的<strong>生活是失控的</strong>。一方面，年轻人觉得社会非常复杂，充满不确定性，他缺乏安全感；另一方面，他又觉得自己的生活没有选择，只有一条路可以走，特别是从小地方出来的或者说一般家庭的孩子，只有考学这一条路。当然现在物质条件还是可以的，但精神压力是很大的，只能一根筋地往前走。这一方面造成很累，同时他又不知道这么累之后，究竟能不能获得他要的东西，因为他觉得这个世界一旦超出他那个“泡泡”（注：<strong>项飙</strong>喜欢用“泡泡”指代边界明确的小世界，比如以考试为中心的、由学校—家庭—补课—电玩构成的封闭世界），是一个好像特别不能把握的世界。从这两重意义上来讲，年轻人都觉得不能够控制自己的生活：第一，不能控制他日常的活动和兴趣，因为有家长、教师和职场的压力，逼着他只能这么做，不管他喜不喜欢都必须这么做；第二，他又不知道这样做会引向何方，他觉得，超出周边的、超出他那个“泡泡”的世界是他完全没有能力去了解的。所以他会觉得“都是运气啊”等，但同时又不断告诉自己“幸运只会光顾勤奋的人”，所以他就要加倍勤奋。当觉得自己的生活失控，感到焦虑、劳累、恐惧和无意义时，他会产生一种很自然的愿望，就是要重新在生活里找到一个抓手，重新找到一个锚、一个立足点。</p><p>那这个立足点是什么呢？家庭好像算一个，但是家庭又是一个很复杂的事情，如果你过分依赖家庭，那个温情也会变成一个很伤害的来源，这是很多年轻人有感触的。然后剩下的社区、单位，都已经没有这样的依托了，不能够发挥这样的作用了。我觉得，大家在“附近”这个意象里看到了一种可能，觉得“附近”可能是一个新的抓手和立足点，是大家重新建立对生活的可控感、至少是可知感的一个基础。</p><p><strong>康岚</strong>：为什么“附近”能够满足这一点？</p><p><strong>项飙</strong>：因为“附近”跟地方、跟社区、跟小区、跟群体、跟部落都不一样，“附近”不是一个有边界的单位。跟“附近”最接近的单位可能是社区，但在社区里面是一群相对固定的人，它有相对固定的边界，内部的关系是稳定的，人员是相对同质的。但“附近”不一样，就像我前面说的，在“附近”，你要看到那些卖菜的、卖早点的、搞保洁的；而且这个“附近”是跟着你走的，你走到哪里，“附近”就跟到哪里。所以“附近”跟社区不一样：第一，它很<strong>强调人的具体的经验</strong>，强调你怎么去看它；第二，“附近”不是一个可以行政化的、可以去客观描述的单位，<strong>“附近”是以你为中心的</strong>。在这个意义上，可能“附近”有它特别的使用价值吧。（关于“附近”的相关论述，参见：项飙，2022；严飞，2022）</p><h3 id="三、关于退出和逃避"><strong>三、关于退出和逃避</strong></h3><p><strong>康岚</strong>：一方面，“附近”是跟着你走的，是以你为中心的。但另一方面，现在的社会又有很强的流动性，所以我们对“附近”是有选择权的，对不对？如果这个“附近”我们不喜欢，是可以逃离的。比如我们会听到，今天的年轻人很难管，“一言不合就辞职”。所以在今天的社会，身边的小环境大家都可以选择，而真正逃不掉的是大环境。所以让年轻人充满无力感的其实是大环境，但他又没有能力去好好建设身边的小环境，这是他们的困境。可不可以这样说，在现在流动很方便的条件下，“附近”的“实在性”很大程度上已经被瓦解掉了？</p><p><strong>项飙</strong>：年轻人对身边的小环境不断在选择、在逃离，但是逃来逃去，其实到最后，情况没有改变。在这个意义上，“附近的消失”跟我原来提出的“悬浮”的概念是有关系的。提“悬浮”，最早是20世纪90年代在东莞调查的时候，我看到有民工跟同事或者跟车间主管闹不合，马上就跳槽，跳槽是他唯一解决问题的办法，但到最后，其实经济上损失很大，一直就没有积累、没有稳定，而且在自己的身心上损失也很大，跳来跳去就是跳不出那个基本的状况（Xiang，2021）。这种对小环境的选择权，可以叫作逃避，通过逃避来简单地解决问题，而不是面对问题。但是，他可以“逃避”，却不可能“退出”，就是他不能够退出这样一个基本的生存状态，这是导致无力感的非常重要的原因。讲到无力感，如果你完全不努力的话，你不会有无力感，佛系的人不会有无力感。你有无力感，是因为你想努力，但又觉得努力没有用，最典型的无力感来源就是通过逃避、通过这样的小的选择希望改变而不能改变。</p><p><strong>康岚</strong>：这个跟“附近”是什么关系？</p><p><strong>项飙</strong>：“附近”是反对这个做法的。我不是说人不要流动，因为个人兴趣、生活方式及各种各样的客观原因，流动是非常正常的。年轻人从一个村子里或从一个小镇上出来，他想在一定的人生阶段去大城市看看，这样的流动是非常自然的。但问题是，流动是不是等于逃避，你不断地流动是不是在永久性地逃避。你离开一个地方，这个本身没有问题，但是你离开后进入一个新的地方，你要能够跟你进入的那个“附近”建立关系，如果又发现问题的话，首先要面对这些问题，在自己力所能及的范围内，先去分析、处理和解决这些问题，那这样的一种态度就不是逃避。所以年轻人对小环境的选择，可以有很多种，如果你一不高兴就辞职，那是要反思的。现在社会的流动成本非常低，这背后是有问题的，它让人不必对具体问题进行认真的对待和分析，有问题就走人，可问题还在那里。用经济学的概念来讲，就是退出成本很低，从而使游戏不用改变规则就能够不断地玩下去，因为你退出了，其他的人可以再进来。</p><p>而“附近”要形成的一个格局是，流动的态度不是一种逃避的态度，而且流出去可以再流回来，等等。最关键的是，在流动的过程中，人是跟每一刻的“附近”发生关系的，觉得每一刻的“附近”都是值得生活的，我是能够浸淫在具体的“附近”中的。</p><p>所以，“附近”本身跟流动不流动没有直接的关系。再说了，现在的流动一定都是人们自己的选择吗？很多也都是被迫的。所以选择不选择是一个很中性的问题，很难说流动就是选择的结果。但不管怎么样，应该用一个生态性的态度去看流动的具体过程和具体结果，看流动在每一步和周边形成什么关系。</p><h3 id="四、关于生态和功能（“附近”的可替代性）"><strong>四、关于生态和功能（“附近”的可替代性）</strong></h3><p><strong>康岚</strong>：讲到“生态性”，我印象很深。您说过，现在我们的城市生活是功能性过剩、生态性不足。功能性是指做一件事情的效率，比如点个外卖立刻送到你手里，今天的技术条件使效率很高。但生态性是跟功能性相对的，它没有那么直接的目的，比如森林里的动物、植物，丰富多样，不管你喜不喜欢，它们就在那里，相生相克，形成一个稳定的系统，这是生态性。今天城市生活的功能性过剩和生态性不足，导致了一些悖论，比如一方面人与人的联系非常方便，做事很有效率，另一方面，年轻人又感到非常孤独无援；还有，年轻人只有在线上才能坦露最真实的自己，而到了线下就“社恐”，变得很有戒备心。所以今天，我们虽然在线上能很高效、舒适地选择各种功能来满足自己的需求，但也慢慢失去了与线下的各种“不舒服”打交道和相处的能力，又回到了前面讲的，如果对线下的生态不喜欢，就逃离。关于生态和功能这对概念，我觉得很有启发，您能不能再具体讲讲？</p><p><strong>项飙</strong>：关于生态和功能的关系，这主要是个态度的问题。<strong>当你把自己的生活当作一个生态的时候，你就不会觉得身边的一切人、一切事都是可以被替代的。</strong></p><p>比如对家庭的看法。在中国，人们经常在语言里把家庭成员说成是可替代的。比较典型的是夫妇之间，会拿自己的爱人和别人做比较，然后做假设，如果我跟另一个人结婚，或者如果你（配偶）能跟隔壁小王那样，我就会怎么样怎么样，把对方认为是可替代的。对孩子也是这种态度，这并不意味着他不爱这个孩子，但他会做这种比较，会说“看别人家的孩子”，倒不是说他认为孩子是可替代的，但是他会做一种假设，就是你可以是不一样的，你在性格上、做事风格上、处事态度上都可以变成另一个人，有时候甚至是必须变成另一个人。为什么觉得你是可以被替代的呢？因为你本身是不重要的，你要为一定的功能服务，这个功能比方说赚更多的钱、有更好的工作、让更多人羡慕，等等。这种（对功能有要求的）态度造成家庭关系内部的一种紧张，给人造成心理上沉重的阴影，有时候是终身的阴影，而且是比较细腻的、比较隐形的。这种态度就不是用一种生态性的视角去看待家庭。</p><p>如果去看邻里、看周边的环境，就更是用一种可替代的眼光去看了。这个东西不好，马上想办法换掉；这个人看上去不舒服，那就不打交道或假装这个人不存在。一切东西都是可以“退货主义”的，一切都要达到最佳组合、最高效率、最佳效果，而不是像你说的生态。<strong>用生态的角度看，一个东西存在，它肯定有可欣赏的地方，你去欣赏它在关系网络里面的一个独特的位置、独特的作用，它和别人之间有一系列有趣的关系。</strong></p><p>我们现在失去了对生态性的欣赏能力。比如，难道每个人都想跟所谓最优秀的人交朋友吗？其实在我们成长的过程中，没有说一定要跟那些特别优秀的人交朋友。一方面，会觉得那些人比较无趣，一天到晚一根筋做一件事情；另一方面，压力也会比较大。有些人可能比较懒散，但也会很有趣，会给你带来一种能量、一种你没有的视角。像小孩子能玩到一块、能成为好朋友，都是因为家住得近，上下学经常一起，这个好朋友不是他选择的，因为小孩子在一起玩，只要基本性格相符，他们自然会玩出“互动性”。小孩子不是从选择开始的，他是从不选择开始的，然后欣赏到对方性格的特殊的地方、互补的地方，这就是生态性。还有我们在社交里面对彼此的评价，也是比较单一的，对人的评价一般就是成功不成功、好与坏。但是一些有趣的人，比如很有文学才能的人，他们对别人的评价是非常丰富的，比方说他们会看到一个人有趣的点就是懒散，能懒散出一种艺术来，等等。但是现在，我们在私下聊天里听到的也都是说这个人成功不成功、优秀不优秀，都是这一套。我感觉，这是把自己的生活做<strong>一种自杀性的简化。</strong></p><p>“附近”的概念不是要做一个社会的宏观理论，它要发展的是一个“生活的人类学”，要讲的是你如何处理自己的生活，让学术思想从生活中来、到生活中去、为生活服务。为生活服务的思想，不可能给你提出一二三的建议和结论，更重要的是提出一些看法、视角、态度，然后你自己可以用这些看法去生活。生态性就是这样一种态度，让你能<strong>更好地欣赏和理解社会的差异性</strong>，以及这种差异性存在的合理性，从中看到它的丰富，看到它的丰满，看到它的奥妙，而不是简单地拿一个效率最大化的标准来评价对方。而这个态度的形成，是需要很多思考和说法在后面支撑的，是要有意识的，就是需要用一定的语言和意象来调动意识的。我在想，“附近”可能调动这样的意识吗？</p><h3 id="五、关于“大”和“小”"><strong>五、关于“大”和“小”</strong></h3><p><strong>康岚</strong>：前面我们讲到大环境和小环境，这里我还想提另外一个“大”和“小”，是关于代际差异的。有一种说法，老一代的人，比如“50后”“60后”，他们其实是有一些大梦想的，家国天下的大梦想，有一些理想主义；而年轻一代，比如“90后”“00后”，他们更关注的是跟个人相关的小梦想、小目标，是更现实主义的。但同时就像您说的，年轻人在网上讨论的又都是一些很宏大的叙事、一些虚无缥缈的大主题，表现出观点的极化和情绪化。这是不是也印证了一点，当大环境影响他们小目标的实现，而他们又没有能力营造身边小生态的时候，他们是最无力的，所以要提“重建附近”？</p><p><strong>项飙</strong>：你讲的代际，这是一个有意思的点，我还没有想到过。问题可能不仅仅是“大”和“小”的区别，更重要的是“大”和“小”的关系。我们讲的“大”，是可以落实到“小”的“大”，还是要把“小”完全忽略的空洞的“大”？老一代人为什么会有宏大的理想，我们要从非常具体的个人经历的角度去分析那些宏大想法对个人意味着什么。对于老一代人，宏大叙事意味着个体可以直接参与改革开放，这个“大”是有道理的。刚刚改革开放的时候，机会非常多，比如当时农民工离乡进城，农民可以感受到自己直接参与一个洪流当中，这是比较真实的。当时整个社会又有很强的一个方向感，大家都觉得要往一个方向去，社会分化不明显，大家都是改革开放的受益者。社会学界的一个重要说法是，20世纪80年代的改革是普惠式的，虽然大家的受益程度可能不一样，但所有人基本上都受益。那个“大”好像是“小”的自然汇集。</p><p>但到20世纪90年代以后，特别是2000年以后，整个经济和社会发展的模式不一样了，不再是普惠式的，而是分化式的，贫富差距变大，不同的人对社会生活的感知不一样，然后是共识的破裂。这时候，个体在自己的生活意义上，没有一个直接的对宏大叙事的参与感；但同时，个体也没有建构出自己的“附近”来，对自己身边的事情也没有参与感。比方说，今天有多少银行工作者觉得真正参与了中国金融事业的发展，有多少律师觉得自己真正在进行中国法治建设的探索，有多少教师觉得在有效地推进某一种教育方式。背后的原因很复杂，比如你的职业生涯被一系列的规则很功能性地定义好了，你就是要发挥规定好了的功能，不允许你有生态性的探索、回到它专业的应有之义上去思考。那么在这样的情况下，他没有对“大”的具体参与，而一些小的公共参与也放弃了，最后剩下的就是用一些非常口号式的、象征性的说法，来宣称一种归属感，对一个想象中的“大”的东西的归属，比如文明。这也是我最早提出“附近”的背景原因之一，我觉得重新对“附近”感兴趣，可以把那个空洞的、大而化之的趋势稍微缓解一下。</p><p>因为你在“附近”跟人面对面地交谈时，你不会绝对性地做判断，你会自然而然地对自己说的话负责任。而那个“大”的东西，因为比较抽象、远不可及，你可以宣泄式地表达情绪，是不用负责任的；这在一定程度上讲，其实是人性的丧失。因为从孔子、从儒学的精华来讲，做人就是要对自己的情绪进行调整和反思，能够达到一种德性，如果直接去宣泄，那是缺德。在“附近”，人的德性自然会出来，因为你会看到“附近”的复杂性和具体性，而且有具体的人站在你对面，你自然会注意到对方对你所讲的话的反应，你会注意到你所讲的话的客观社会效果，其实这是一个德性培养的实践过程。孔子、荀子、亚里士多德都很强调“养成”，在他们看来，德性不是一个大的理念问题，而是要在实践中、从小处、从日常逐步培养，一点一点“修”出来的（Aristotle，1999）。“附近”就是“养成”的一个处所。</p><h3 id="六、“附近”的价值：“附近”是在大环境给定的条件下，让普通人能够保持思考和行动能力的小空间"><strong>六、“附近”的价值：“附近”是在大环境给定的条件下，让普通人能够保持思考和行动能力的小空间</strong></h3><p><strong>康岚</strong>：我感觉现在有时候大家在行为和观念上有一种很大的张力和分裂，一方面对环境的抱怨很厉害，另一方面又身不由己地甚至很努力地在维护既有的环境和规则。包括您前面提到的各行各业专业人士的公共参与的微妙，我们经常能听到的一个说法是，我个人再努力也无法改变大环境，那我不如顺势而为，先把自己的小目标安排好。于是，个人所有的行动都在配合和维护那个现存的让人不满的东西。这是中国特有的现象吗？抱怨和维护同时存在，这其实会导致一个长期的、很大的压力。</p><p><strong>项飙</strong>：既有埋怨又有维护，这是人类的一个普遍现象，但中国现在的特殊性是，埋怨和维护都比较激烈。埋怨是觉得看不到希望，维护是因为被一种恐惧所驱遣，觉得我这一步走不好，可能对我的影响会很大，然后他的维护就不仅是消极地维护，而是很积极地投入式地去维护，所以两边的表现都比较极端。这种极端造成的心理的无力感是很强的，他明明知道自己在做一个自己不认同的事情，但还是在“鞭打”自己，非常努力地做一个自己非常不认同的事情。</p><p>“附近”作为“为生活的人类学”的一个例子，受到存在主义和实用主义哲学的影响，它背后很重要的一点想法是，<strong>人没有办法对生活和世界做一个整体性的批判，不能等对生活有了全面判断之后再去生活</strong>，关键是在当下给定的条件下，不要让自己的思考能力和行动能力丧失掉。这其实是很难的，所以要找一个现实的、很小的突破口或者说抓手来做。</p><p>你刚才说的这种两难境地其实是讨论“附近”很重要的背景。我国外的朋友觉得很奇怪，他不明白“附近”有什么有趣的，这不是最简单的东西吗？我要说的是，不是说“附近”本身有什么特殊性，它就是最平常的，但我们现在的生存环境比较扭曲，所以有没有一个东西是我们普通人能够抓得住、能让我们普通人多一点坚韧性的。在这种扭曲的状况下，如果能有一个空间，有一个我们自己可以抓得住的、可以喘息的地方，这就是“附近”的价值。</p><p><strong>康岚</strong>：那“附近”到底能够扮演什么样的角色呢？</p><p><strong>项飙</strong>：“附近”可以扮演什么角色，要靠大家一起探索。但在理论上讲，我觉得至少可以有两点。</p><p>第一点是，对总体性的抱怨至少可以变得更加分析性一些、更加具体一些，看看在一些很不合理的情况下，是不是还有一些小的空隙、小的突破口，在一些具体的场景下可以让你发挥自己的能动性。我给你举一个浙江村的例子。浙江村的第一批农民1986年来到北京，要自己租房子、要做衣服卖，这在政策上是完全不允许的。当时的户籍制度本身、城市管理制度、派出所和警察对他们的态度，使这些人在北京的生存空间是零。那他怎么会打出一大片空间来，很重要的就是他的“附近”意识。他不管那些正式的制度，他在他的“附近”、他的周边看，这些有实权的、掌握着土地资源的、能够出租房子的人都是谁？他们彼此之间是什么关系？他们发现，“附近”的权力关系是特别复杂的：在城乡结合部，有中央部委、有北京市的单位，还有区的单位，还有乡和村，这些部门还有自己的三产公司或门市部，这些单位都有权来处置自己的土地和资产，而彼此管不了。这帮浙江人就是在这样一种生态里面找出了很多空隙，最终他租到了房子、盖起了厂房；遇到清理的时候要跑，他就把缝纫机等东西交给房东代管，等清理完了再回来。这些浙江农民到北京，他们完全是体制之外的人，但是他们就是在具体的“附近”里面找到了各种机会。</p><p>这给今天年轻人的启发可能是，你要有这样的勇敢，<strong>要有退出的勇敢</strong>。前面不是讲到退出和逃离吗？你不断地逃离，很多时候是因为你不敢退出，你总是觉得要更好、要更受主流欣赏，然后你又不愿意去解决问题，就不断地期望能逃到一个相对好一点的地方，现在这越来越不可能实现了。像浙江的这些农民，他完全是流动的，但他不是逃离，他流动过来之后他就看、就找新的机会；他的流动其实是一种退出，他退出原来的城乡控制体系，这是他的勇敢。退出之后当然是有风险的，退出之后自己的粮食怎么来，生计怎么弄，这些是不知道的，都得靠自己去闯。</p><p>当然，“附近”不是要搞什么岁月静好，你还是要看到各种各样的矛盾和不合理的地方，但是不能够让自己彻底瘫痪掉了，这不行。哪怕在最不乐观的情况下，你一定要在“附近”里面找到一点光，为自己生活的改变找到突破口，哪怕有时候不得不做一些妥协，但要有这份勇敢。这是“附近”角色的第一方面，怎么样在无法改变总体情况的时候，从“附近”找到一点改变的力量。</p><p>第二点是，“附近”也会给你一点力量，不用那么刻意地去维护主流。维护主流的一个重要原因是，自己在这个世界上没有安全感、没有归属感，觉得唯一的价值的来源、尊严的来源、认可的来源，以至于生计的来源，就是要为主流服务。其实是不是这样呢？如果去城乡结合部走一走，你会发现很多人的生活不是这样的，那为什么我们不可以呢？去维护主要是一种害怕。很简单的，如果你在学校的班级里，或者在公司的班组里，或者在社会上的朋友圈里，是彼此<strong>信任</strong>的、<strong>团结</strong>的关系，你们<strong>表达自己的声音的胆量就会大一些</strong>。</p><h3 id="七、二次元的强大是因为线下的困难太多，如何走向三次元的生活是一个重大挑战"><strong>七、二次元的强大是因为线下的困难太多，如何走向三次元的生活是一个重大挑战</strong></h3><p><strong>康岚</strong>：前面我们讨论较多的是“附近”的实践价值，但是现在年轻人都很重视精神和情绪价值。您在谈论“附近”时，专门提到“附近”有时候会让人“不舒服”，因为要处理跟不同人的关系。我感觉，这种“不舒服”跟现在年轻人的追求是正好相反的。今天的年轻人虽然有很现实的一面，但也很看重一种舒适的感觉和精神上的契合性，如果让他不舒服了，他可能会逃离，就像我们前面所讨论的。现在的一些青年精神文化现象，比如网游动漫、国风文化、网红文化、盲盒文化、打卡文化等，都是非常梦幻性的、感受性的、情感性的，年轻人对这些东西的追求，往往是通过网络而不是自己生活的“附近”，他们会把现实世界和虚拟世界分得很开。那么，“附近”到底能不能为年轻人提供精神价值？</p><p><strong>项飙</strong>：“附近”的精神价值是很重要的。我觉得，<strong>“附近”的精神价值高于它的实践价值</strong>。你讲的青年的精神文化现象，我们可以简单地把它叫作二次元现象，是虚拟的、非常象征化的。现在的科技发展，象征已经不仅仅是符号，它可以直接去体验，因为它可以动起来，带着丰富的色彩和声音，对神经形成直接刺激，给人的感觉是得到精神上的满足。这里有两个情况：第一是时间性，我们要看到这种二次元现象跟一定的年龄段有关。我觉得到大三、面临大学毕业的时候，会有一个转折，当他走向社会的时候，我很难想象他可以通过这个来满足日常的精神需要。第二是回到线下的问题，特别是在他即将大学毕业，面临找工作、考研、考公等问题时。现在年轻人的精神世界，我觉得不是二次元世界有多么丰富，能给他们多少满足，而是年轻人不知道如何走向三次元的线下生活，所以使劲地趴在二次元里，在三次元里活几个小时，然后跳回到二次元里活几个小时，有时候把三次元当作二次元来活。</p><p>在一定的年龄段，年轻人的线下和线上世界是分得很开的，而且他是完全知道自己在把它们分开的，有时候是刻意地分开。这个分开对他本身的自我认知、对他的生活认知、对他的情感世界，影响是非常大的。他在这里可能会有一种错落感，一种无力感，因为生活好像是一直在不断地切换，而永远不能直接面对。因为他没办法理解对他物质生活有直接影响的那些事情究竟是怎么回事，所以他就顺着走、不管了，你让我做什么就做什么。比方说中学的时候，让我考试就考试吧，我也不问考试有什么道理，问了也没用，然后一有时间就把自己全身心地泡到电玩里面去。</p><p>现在二次元文化变得那么强大，不是一个自然的现象，很大程度上它就是一个逃避，因为现实中困难太多。现在一些年轻白领下班后是从来不做饭的，都是叫外卖什么的，直接玩电子游戏，玩到11点睡觉。我们可以说，他的精神生活通过电玩得到了满足，但是他会直接告诉你，他是不开心的，他去玩电玩就是觉得日常生活的压力太大，这样的日子过上一段时间之后就是一个非常疲惫的状态。</p><h3 id="八、从“附近”的“不舒服”中看到有意思的地方"><strong>八、从“附近”的“不舒服”中看到有意思的地方</strong></h3><p><strong>康岚</strong>：现在有一些数字娱乐，在某种程度上，好像替代了现实中的某些亲密关系的功能，比如虚拟男友/女友，“云撸猫”等。在我们看来，这些都是完全虚拟的形式，它满足的是一种精神上的需要，但其实这反映了现实不能满足年轻人精神上的需求。还有我们一直在说的年轻人集“社牛”与“社恐”于一身，在线上跟不认识的人话很多、能坦露最真实的自己，在线下却非常沉默，跟家人都没什么话说。为什么现在年轻人的现实感这么弱，在现实中找不到他们精神的落脚点？到底是年轻人出了问题，还是现实出了问题？</p><p><strong>项飙</strong>：这个当然不能怪年轻人，他们作为新的一批人进入现在的生活场景里面，这个生活场景不是他们造的，是老一辈留下的，所以不能怪他们。但是改变还是要靠他们，为他们自己的更好的生活！如果有人说，这种虚拟性的存在已经满足了我的一切需要，所以我不需要线下的互动，那这时候我们应该怎么样面对？</p><p>这个现象也不是新的，像日本的宅男和社会自闭症，就不是一个生理性、神经性的自闭症，而是选择性的自闭症。这（指自愿性自闭）对我们社会科学研究来讲，真的是一个挑战。如果社会科学研究是不做判断地去描述，那么只能是记录了这些年轻人怎么选择，说他们有他们的道理；如果社会科学研究要有明确的结论和建议，直接告诉年轻人自闭不好，也没有实际的效果。很多人知道这样不好，但是在很具体的场景下，他们觉得这是最自然的选择。我觉得，<strong>社会科学需要发展出一套话语，把年轻人的现实感丰富起来，发展出前面提到的生态性的视角，从现实中的“不舒服”当中看到有趣。</strong>“舒服”不一定是有趣，舒服其实很容易是无聊，因为舒服的东西只让你一味放松，不刺激你，不调动你，是没有什么回味的。但是“不舒服”还是不舒服，它不会自动变得有趣，这就需要有一定的能力来做这个转换。你说的“现实感”可能真的就是这个转换能力，把日常看似无意义的琐碎转换成有意义的叙述。一个人看到某个“不舒服”，可以开始好奇：为什么我感到不舒服，为什么那个人觉得很自然，是什么力量把自然变成奇怪，把奇怪变得看起来无可厚非？这不是很有趣吗？</p><p>一味追求舒服，就是没有现实感了。比如说现在一些年轻人要求网络小说要写得所谓“双纯”，就是要求里面的男女完全没有谈过恋爱、不能够有过性经历等，要非常纯洁的。这样去理解爱，那根本就不是爱。<strong>人作为人，去理解情感和精神上的东西，其实正是要去理解人本身的复杂性，从中看出微妙。<em>纯洁这个东西是人想象出来的，而生活的过程本身就是不纯洁的。</em></strong> 所以，人要在不纯洁的实践当中，看到毅力，看见智慧，看见人的德性，看见人对人的关怀是怎样的。在一个很复杂的情况下，在难以决定的情况下，我们怎样关心别人，这是有趣的东西。纯粹这种观念，其实是现代性本身（派生）出来的东西，因为生活变得非常复杂，没有一个稳定的叙事，大家感到迷茫，迷茫之后就需要去想象这种纯粹。比方说浪漫主义，浪漫主义是很重要的一个现代文艺思潮，有很解放的一面，但是浪漫主义对欧洲的极权政治也有影响，包括法西斯主义的兴起也与它有关系，因为它有那种对所谓纯粹、崇高的追求，这种脱离现实的对崇高的追求造成了极大的破坏性。所以，“附近”代表了我所谓乡绅学者（笑）的态度，觉得让“附近”进来，不要靠这种纯粹的、浪漫的东西来获得精神的满足，让精神的满足来自对现实微妙的、细微的观察。</p><p>这是可以发展出一种美学品味的。比方说让你和我去读小说，我们肯定会觉得那些所谓“双纯”的小说是没什么可读的，都是讲一些甜言蜜语、美轮美奂的东西，可能第一次看会有一点吃糖的感觉，但看第二本肯定就不愿意了；我们要看的还是那种让你不愉悦但是能让你信服的东西，鲁迅就是最好的例子。像鲁迅这样高度的思想家和文学家，他写的东西90%以上都是让你很不舒服的，但是中国人对他的爱和感激，那是很深的，这就是一个好的例子。是鲁迅的作品带给你的精神满足性强，还是那些高度形式化的东西（比如小孩子穿上汉服、坐在台上背三字经）带给你的精神满足性强，这个大家一看都明白。鲁迅的作品是把你调动起来，让你去思考、去睁大眼睛看矛盾，让你变成一个思考的主体，他刺激你、不让你安心。<strong>虽然你还是不能控制世界，但是你至少感到，我作为一个主体在世界上存在了。</strong></p><h3 id="九、原子化生存强化了社会同化的趋势，使自我的主体性变得虚幻"><strong>九、原子化生存强化了社会同化的趋势，使自我的主体性变得虚幻</strong></h3><p><strong>康岚</strong>：接下来我想谈谈原子化的问题。现在中国社会的个体化有一种脆弱的原子化现象，尤其是一些沉迷于虚拟世界的年轻人有一个比较明显的沉醉在自我世界的问题。我想问，数字技术在塑造个体的心理、个体和社群的关系上，到底有一个什么样的作用，以及随之会在思想文化上、社群结构上带来一种怎样的蜕变？现在我们看到的很多现象其实是有一些个体的异化或者脆弱的个体化问题的。另外，技术的这种影响应该是全球共通的，国外也是这样的吗？还是说这是现在中国年轻人比较特有的现象？</p><p><strong>项飙</strong>：我觉得国外肯定也有这样的情况，特别是在日本确实是这样。因为数字化技术提供了一个无接触社会的可能性，可以不用出门就买到东西，这使原子化生存成为可能，这当然是有很大影响的。这里我可以讲三点吧。</p><p>第一，虽然数字化是形成原子化生存的重要的物质条件，但现在我们在国内看到的这种原子化现象，到底在多大程度上是因为数字化技术本身造成的，我是有点存疑的。我总觉得是因为我们的现实没有给年轻人提供足够的吸引力和他们可以参与的地方，所以他们把数字化当作一种逃避。我举个例子，在大学里吃中饭的时候，你会看见很多外卖员排队送餐，我觉得好奇怪，因为大学食堂就在你楼下，怎么会需要去叫外卖？学生给我很多理由，比如外卖更好吃、外卖比较便宜（因为平台有补贴）等，但是还有一个很重要的原因是，很多人觉得下楼见人要打招呼太累。这跟我们过去到食堂吃饭的感觉很不一样，过去我们去食堂吃饭不仅是要吃东西，也是觉得在打饭的路上可以跟同学一起聊天啊。但现在的大学生觉得这一切好像都是负担，也不知道聊什么，见了人很紧张；本来见了人就要逃，现在有了数字化技术，他当然是要用它了。同时我们要注意到，这不是一个简单的技术问题。这个技术之所以能满足你生活的各个方面，是因为有人可以从中赚钱了，你买的东西送到你手上，是有人开着摩的跑来跑去，在高度紧张甚至危险的情况下把东西送过来，而这些你通通都不用管。数字化的真正奇妙是它为你屏蔽了你跟生活的很多真实联系，使你对生活的真实联系无知无感、不感兴趣，是在这样的情况下把你推向了数字化生存。这里面有资本的运作，创造出很多花招把人们引向数字化生存。所以，这不是一个完全的技术过程，或者说这首先不是一个技术过程，而是一个社会过程。</p><p>第二，刚才你讲得很好，这就是一个悖论。一方面，年轻人觉得自我非常重要，可以说是沉溺于自我；另一方面，自我又是非常脆弱的。怎么去解释这种脆弱的自我中心？</p><p>我觉得，我们要反对自我沉溺，并不是要去消灭自我，但是就像前面你讲到的，最重要的并不是自我，而是自我和别人的连结。不是要你去消灭自我，其实是相反的：你需要对自我有丰富的认识，说话有底气、落落大方，面临事情，你至少知道这个事情该怎么去思考、怎么把它分解，该跟人商量就跟人商量，不该跟人商量的时候自己也能够把事情理出头绪来，哪个重要，哪个不重要，然后做出一个选择，选择之后如果事情办不通怎么办，办不通也不会后悔，因为自己已经做了全面的思考，等等。这些都是极其重要的自我啊！就是你知道自己是作为一个主体活在世界上的，这种感觉是不可能靠一个封闭的自我来实现的。这些一定要通过对周边的观察、反思、分析，慢慢得出一些人生的智慧。</p><p>将自我完全沉溺于电玩里面的年轻人，确实是比较令人担心的。他在情感上可能会非常冷漠或者非常敏感，一会儿高兴，一会儿不高兴，伴随大脑里面各种化学物质的分泌程度而定，下场雨都会觉得很烦，会有大量的化学分泌物出来，人就变成像一个化学体去应对外界的随机刺激，没有自己的主宰了。这样的自我不容易控制自己的感受，更遑论对别人、对世界、对各种各样发生的事情的应对能力了。所以，<strong>自我沉溺式的自我到最后是消灭了一个社会性的自我</strong>。</p><p>第三，是跟第二点相关的，怎么理解自我的中心化和自我的脆弱化是一体两面的过程。一个没有“附近感”的自我、一个沉溺于虚拟世界的自我，最终会变成一个无差别的自我。现在很大的问题是，我们的教育制度导致在青年人中，人与人之间的差别是非常小的，在娱乐方式、思考方式和人生的规划上，都有高度的一致性。高度一致性意味着大家一条心统一思想吗？不一定。现在的高度一致性造成的直接后果是：第一，没有真正集体的团结性出来，因为这种高度一致性都是在互相竞争，在同一条道路上把别人甩掉。第二，<strong>在这样的高度一致性情况下，形成的其实是一个对自我很大的不确定和恐惧，因为看上去别人都跟自己是一样的，想要不一样，需要刻意努力地做出来</strong>，比如买的房子大一点。所以在这样的高度一致性下面，人的社会性也变成一个很大的问号，<strong>因为自我作为主体的存在变得比较虚无缥缈；而且，人和人之间的关系容易变成一种竞争与怀疑的关系，而不是一种互相欣赏和互补的劳动分工的关系。</strong> 我觉得，现在沉溺于虚拟世界是强化了这种同化的趋势。</p><p>上面讲的三点，其实都是要回应你说的原子化问题，特别是在数字技术条件下，怎么样去考虑原子化的起因和后果。</p><h3 id="十、“心理健康热”背后是对现实困境的一种强烈的问题意识，这是年轻人中的主流"><strong>十、“心理健康热”背后是对现实困境的一种强烈的问题意识，这是年轻人中的主流</strong></h3><p><strong>康岚</strong>：国内最近几年，心理健康问题和抑郁症的风险在上升，在青少年中这个现象尤为突出。这跟原子化问题也有关系，以及新技术条件下的加速社会导致的个人的无力感。现在“抑郁”已经成了一个时髦词，好像人们不说自己抑郁都不是现代人了；上海的精神卫生中心宛平南路600号，已经成为一个网红标签，带有600号标识的产品都卖得很好。当然，这里有一点调侃的成分，但确实社会整体的抑郁风险在上升。不知道从全球看，是不是也有一个同步的上升？从世界范围看，是不是年轻人普遍都在经历一场精神危机？</p><p><strong>项飙</strong>：从全球来看，我觉得肯定都有（这个趋势），但可能程度不太一样。当然我们这些年本来就有“心理热”，在疫情之前就有，疫情期间又变成一个全民化的问题。我们原来觉得，心理健康问题跟教育水平有关系，但现在在国内，我们看到农村的、小镇的、低教育水平的年轻人，他们的精神健康问题也变得非常突出。我现在好像还没有注意到，世界上有其他哪一个大国或者大型社会像中国这样，对精神健康问题有这么强烈的意识，比方你说的上海精神卫生中心现在变成一个流行符号。对我来说，这种意识是非常好的，因为大家不避讳了。原来觉得，得了精神方面的疾病好像有一种病耻感，现在年轻人完全没有这种概念了，这在20年前是不可想象的。</p><p>大家会这样广泛地讨论自己的心理问题总的来讲是一件好事。为什么是好事呢？我觉得，这里有一个很强的问题意识在里头，大家觉得生活里面有问题，是需要去解决的。但究竟问题的根源在哪里？怎么去解决？当然大家没有方案。但是大家觉得，我们现在需要讨论、需要去反思、需要去探索。我觉得，这种问题意识在年轻人当中其实是主流，大家觉得按现在的方式继续往前走，解决不了问题。</p><p>这可能也解释了为什么大家对像“附近”这样的概念有兴趣。大家有兴趣，真的不是知识上的好奇，他真的是从生存的角度对这个概念产生了兴趣。这里的“生存”不是说要找饭吃这样的生存，是生存感，或者说存在感。存在感这个词可能更好，就是我在这个世界上究竟要以什么状态存在，存在的意义在哪里，什么东西让我不仅在短期觉得快乐、在长期也觉得有意义，可以一直干下去，可以平和地但是又觉得不断有干劲地干下去，可以不用去逃避，可以不断勇敢地去拥抱、去追求的存在方式。目前大家找不到这样的一个存在感，这也是“附近”能够得到广泛讨论的一个原因。</p><h3 id="十一、代际关系问题：“附近”的建设最重要的是“日常性”，这方面年轻人要向老一代学习"><strong>十一、代际关系问题：“附近”的建设最重要的是“日常性”，这方面年轻人要向老一代学习</strong></h3><p><strong>康岚</strong>：我想再谈一下代际关系的问题。今天中国社会的代际冲突非常明显，包括微观和宏观的代际关系。在家庭范围之内，年轻人觉得长辈太烦，不愿多交流。关于宏观的代际关系，比如在疫情期间，社区的组织以居委和老年人为主，这种主体地位不能动摇；但同时，像小区团购这些，主要是年轻人在组织，他们做得很好，也非常体现公共性，包括一些社区公益，众筹款项给物业人员、独居老人送物资，帮小区对接第三方公益组织等；但这些似乎又有点干扰居委的主导地位，于是反过来年轻人会被教育不要添乱，这就打击了年轻人对社区的主动参与和积极性。其实在疫情之前，很多年轻人跟社区和居委的关系是比较疏离的，觉得跟自己没什么关系，居委就是执行上面的命令。社区是跟“附近”最接近的单位，如果以社区这个生态为例，可以看到是有权力关系的，目前基本上是老年人和行政力量在主导，这个问题您怎么看？这种权力关系是否会驱逐年轻人对“附近”的参与？</p><p><strong>项飙</strong>：在中国，代际关系对于“附近”的建设非常重要，可以从正反两方面讲。</p><p>一方面，老年人，现在已经退休的六七十岁以上的人，他们是唯一对“附近感”有直接生活记忆的一批人，他们在“附近”建设过程中是一块宝藏。在小区里面跟人有一搭、没一搭聊天的，肯定都是五十岁以上的人，能够有这种“厚脸皮”、有兴趣、有技巧、知道怎么在买菜的时候跟人聊天、知道别人家里都是干什么的，都是老年人。还有一些活动，比方说广场舞等，也是很重要的“附近”建设，跳广场舞时他们把孙子孙女带过来，也给很多孩子创造了一定的空间。现在的孩子基本上是没有什么“附近”的，学龄儿童对“附近”的一点点认识往往都是通过他的爷爷奶奶外公外婆来获得的。这些老人是在二十世纪六七十年代成长起来的，那时候的中国跟东欧、苏联这样的大企业社会主义不太一样，中国的单位大院其实有很强的农村性质，孩子在大院里到处乱跑，今天在这家吃饭，明天在那家睡觉，这种情况经常发生。很多来住厂区宿舍的员工父母都是农村过来的，大家日常都按农村或者半农村的习惯混在一起，这在其他的社会主义国家基本上不太存在。在欧美国家，资本主义的街区分化很严重，没有像我们这样的既高度密集且大家的社会背景又多元的带有农村色彩的单位大院。老年人有这样的记忆，他们成为居委会的骨干和领导也是有道理的。年轻人在突发事件之下，用理性的办法、用现代的方式组织起来处理问题，可能会做得更好，比方说像团购。但我觉得，年轻人可能还是要像老年人虚心学习，因为“附近”的建设最重要的是一个“日常性”，它不仅是做一个项目，更重要的还是要把这个东西转化为一种日常，它是一种态度，是一种存在的方式。像团购，各种情况都有，有做得非常好的，也有半路解散的，让我惊讶的是后者，因为在那样困难的情况下，大家已经到了买基本生存物资自救这样的极端情况下，怎么还会出现内部的纷争和指责。我在这里得出一个假设性的想法是，我们在基层日常中建设民主的能力真的是太缺乏了，这跟“附近”是有关的。人和人有不同意见的时候，怎么样把这个事情摆平，或者先不下结论，想着把事情先往下做。有人挑头，但要有人主动出来分工、分担、分享，这些都是常识性的智慧，没有很大的道理可言，但生活智慧其实是影响我们个人生活最重要的东西。团购很快就消失了，有其他原因，但也说明它确实是针对特定目的的一个行动，而不是一个日常性的存在状态。在这个意义上，我觉得老人家的那种精神和态度，还是值得学习的。老人家对生活的感知是更加丰富的，他不会有那么多抱怨，就像前面我们讨论的抱怨和维护，他们在抱怨和维护的两极都比较不那么极端。</p><p>另一方面，老一代也可能给“附近”建设造成困难。在现在比较正式的话语里面，基本上是用“50后”“60后”的那一套符号来控制对生活、对社会的叙述。这个好像现在谈得不多，但我觉得是值得注意的。年轻人觉得压抑的一个原因是，他们自己的生活感知跟目前主流对生活的叙述有很大的差别，因此他们在讲自己的生活的时候，只能自己造梗，比如孔乙己、打工人、小镇做题家、废物等，现在造的梗越来越多，都是自嘲性的，看起来都是负能量的。而那些正能量的话语都是“50后”“60后”他们青春时期提出来的东西，比如有国才有家、要牺牲、要顾大局，等等；在二十世纪五六十年代，这些话语是跟当时青年人的生活经验有关系的，当时人们对这些表述感动是有经验基础的，但是在今天，这些话语所指的那些东西究竟是什么？这些东西跟今天年轻人的日常焦虑是什么关系？这个目前不清楚。然后，<strong>年轻人自己也没有一套话语可以在主流媒体上系统地去讲述整个社会应该怎么样前进等。</strong> 现在我们没有一个接地气的（比方一个理想生活和理想社会应该是什么样的）说法；一讲到理想，还是说要继续繁荣、要国富民强、要在国际上拿得出去，没有在个人体验和心灵感受的意义上能让人满足的说法出来。为什么年轻人处处感到“爹味”，为什么回家觉得压抑，跟这个是有关系的。也不能说老一代掌握了话语权，但是主流的话语用的是老一代的那套符号，用的是老一代年轻时候的形象，所以老一代讲起来就很兴奋，一下子回到青春了，但是这些符号究竟和老一代当年的、后来的、现在的现实考虑有什么关系，好多老一代的人可能也是不去多想的。比如老一代可能就不会讲“附近”，只会讲“万众一心”“团结”“听集体的话”。他们可能会觉得“附近”很琐碎，没什么意义，但是他们当时之所以有“团结”的感觉和那股气势，和他们日常生活中的“附近”是有关系的。<strong>可惜主流话语把生活经历抽象成宏大的象征，让有些人觉得毋庸置疑地拥护，让下一代人摸不着头脑、也不知道怎么去修正和发展这些想法。</strong></p><p>简而言之，老一代人的生活经验是财富，但是他们所熟悉的那套话语现在有一点被僵化成说教，这让年轻人感到很压抑。但我觉得，主动权还是在年轻人手里，要改变，年轻人要主动去学习老一代的生活经验；同时对那套话语不要太在意，然后慢慢自己发展出一些说法。所以造梗也是一个做法，是一个开始。先有一定的空间，然后再慢慢地有一些更加正能量、能给人指明方向同时又能够触及个体心灵的一些话语出来。</p><h3 id="十二、性别关系问题：女性的友情比较持久，有很强的互相支持在里头，这就是一种“附近”"><strong>十二、性别关系问题：女性的友情比较持久，有很强的互相支持在里头，这就是一种“附近”</strong></h3><p><strong>康岚</strong>：讲到让年轻人感到压抑的关系，代际关系是一个，性别关系也是一个，两者对年轻人参与“附近”，都有比较大的影响。一方面，中国现在的性别关系确实有张力，尤其是女性在这个关系中的感受可能不是特别好。另一方面，这两年比较明显的问题是对婚育率下降的担忧，这个在近两年的公共讨论和社会情绪方面，我觉得有一点好心办坏事的味道。其实年轻人吧，可能也就是晚婚或者暂时不想谈恋爱，但现在整个社会舆论给年轻人一个很大的压迫感，比如“保卫家庭”这些话语，让年轻人更加恐婚恐育，张力特别大。我觉得，婚育本身是构成年轻人“附近”非常关键的生命事件，无论是处理恋爱关系、夫妻关系还是亲子关系，都是现实感和日常性特别强、特别需要生活智慧的事情。对于中国的性别关系以及目前在年轻人婚育事情上的舆论张力，您怎么看？</p><p><strong>项飙</strong>：亲密关系和附近关系是需要澄清的一对概念。我提出“附近”，是有一点跟家庭相对的意思的。在中国社会，资源怎么分配和组织、人生怎么规划，其实现在家庭变得越来越重要了。现在的很多不平等是通过家庭传递的，比如啃老等，家庭内部的压迫感与这个有关系。现在不是说老人变得更加传统保守，其实很大程度上是一个经济问题，因为年轻人越来越依赖于家庭、不得不依赖于家庭。</p><p>像我们那个时候，特别是小城市出来的人，家里的老人肯定更加保守啊，但是年轻人也无非是过年的时候稍微装聋作哑听一听，但自己反正经济独立，老人家遗憾归遗憾，哎呀怎么还不抱孙子呢，但慢慢也接受了。但现在年轻人要靠老一代的资源再分配，既然你没闯出自己的一条路，老年人也是出于他们的关心和教育，那“爹味”“妈味”就都出来了，所以这是一个家庭的重新的中心化；这是一个完全没有想到的事情，我作为一个搞社会学研究的人，在二十世纪九十年代完全没有想到今天会有这个变化。“附近”的意思就是，你不要把自己关在家庭里面，你要多看看周边；同时，老一代也不要把自己所有的生活意义都放在家庭上面，孩子什么时候成婚、什么时候有第三代等，老一代也要更多走出家庭，让自己生活意义的来源更加多样一些。</p><p>第二点，你说的亲密关系，特别是在寻偶、在爱情的意义上，“附近”原来是一个很重要的支点。过去，人们一般都是在“附近”找到了恋爱的人，都是原来跟你生活就有交集的人，这样才认识，认识以后通过一定的实际的接触才会产生感情。最典型的比如同学、工友，或是朋友的朋友、父母的朋友的孩子等，所以亲密关系和附近关系是有一个逻辑连贯的，是从附近关系的一部分转化为一个亲密关系。这样的转换的一个结果就是，很多夫妻会有共同的朋友，有时候两三对之间都是多方位交织的朋友关系，“附近”和亲密关系是交织在一块的。</p><p>现在因为有了寻友这样的App，对这个造成一定的冲击。但是我也观察到，寻友App会倒过来让亲密关系成为某一种“附近”建设的源泉，它会把不同的朋友带到一块。即使靠App，一般亲密关系还是在一定的空间范围内进行的，可持续的亲密关系还是有一定的在地性的，会形成一个因为亲密关系而带出来的“附近”，如果有这方面的研究或例子的话，我也很想追踪看看是怎么发生的。</p><p>第三点，关于性别上的压抑和家庭的重新中心化问题。这一点，我倒觉得它跟“附近”没有直接的关系；相反，我觉得在某种意义上，“附近”是抵抗这种压抑的一个工具。我们知道女性对日常社会关系的兴趣和对社会关系的投入一般要比男性大得多。我给你举个例子，根据一些社会学调查，那些在海外的华人老太太、华人老头，就是到国外去帮忙带孙子的老人家，老太太对“附近”的了解要比老头好得多。因为老太太要照顾别人、照顾家里，要接孩子放学，要出去买菜，这些事情会让她跟“附近”发生关系，老头儿不太做照顾工作，所以就很容易变成一个自己待在家里的人，慢慢就成了一个老“社恐”，也不知道怎么说话，出门也不知道怎么坐车等。我想说的是，<strong>女性出于照顾和关爱会更熟悉附近，因为照顾和关爱其实是附近性很强的一种工作。</strong> 想象一下，如果你家里有残疾人，你必须对“附近”非常熟悉，因为要考虑他怎么出行等；你如果要照顾一个重度残疾人，比方说经常要推车到附近散步，那么哪里可以走、哪里不可以走，哪一段路有问题、怎么想办法去解决，你会投入地去想、去推动这些事。今天的年轻女性即使不承担照顾的义务，也有各种结社行为，比如“闺蜜”现象。闺蜜这个现象不能够把它太简单地处理，为什么女性会有闺蜜一说，很重要的是因为女性面临的社会压力更大，这个压力往往是来自各种跟性别角色有关的问题，比方婚姻生子、就业当中受到的歧视或者工作中遇到的骚扰等，所以女性对友情的需要比男性可能要更高。女性的友情比较持久，有很强的互相支持的意思在里头，这就是一种“附近”了；它不一定完全是一种空间意义上的“附近”，但是它给你创造这样一种生态，让你更有坚韧性，为你提供一种支撑、一个抓手，碰到问题之后，至少有人可以跟你谈、可以一起去分析。这就是一种“附近”的生活智慧：不放弃你的立场，同时又非常务实地面对问题。所以如果我们要考虑“附近”下一步该怎么走，其实我觉得从性别政治里面是可以学到很多东西的，因为性别政治一方面其实原则性是蛮强的，但另外一方面，它又不允许你做简单化的处理，更不能用抽象化的方式来处理，它需要一种坚韧、持续，需要用一种务实的智慧去处理。</p><h3 id="访谈最后：我们必须有意识地抵抗无力感">访谈最后：我们必须有意识地抵抗无力感</h3><p><strong>康岚</strong>：项老师，感谢您接受我们的访谈。最后，如果请您对今天这个时代焦虑、迷茫、充满无力感的年轻人说几句话，您最想对他们说什么？同时，如果邀请年轻人在读了这篇访谈后，写邮件（<a href="mailto:xiang@eth.mpg.de">xiang@eth.mpg.de</a>）来告诉您一些有关他们的个人经历，您最希望年轻人来跟您交流什么？我们希望这篇访谈只是一个开始，希望它为今天的社会、今天的社科研究者和年轻人的交流与对话提供一个契机，我们《当代青年研究》杂志也希望为未来更深入的对话提供平台。</p><p><strong>项飙</strong>： <strong>我们必须有意识地抵抗无力感。如果说我们在生命中有什么义务的话，不让无力感把我们击垮就是一个重要义务。存在主义说，我们来到这个世界上这件事，是纯粹随机的、无意义可言的。所以，不可能有一个你和这世界之间必然的和谐。</strong> 人活着要有意义，这个意义是要靠自己创造的，要靠自己摸索出和世界的和谐关系。从这个角度看，无力感、无意义感也可以说是生命的起点，所以不用太怕它。那么，怎么具体地摆脱无力感？我们可以看一下它的历史根源，无力感不是无缘无故地来的。今天的无力感是不是跟昨天的亢奋是一体两面的东西？如果社会给了我们一个正向的反馈，我们就亢奋，觉得一切都是在向上的，觉得批判都是多余的；那么社会一旦给你的反馈是负面的，你一下子就会觉得是无能为力的，觉得勇敢是矫情的。这是没有看到社会和个人处在非常复杂的互动过程中，把生命过程想象成了实验室里老鼠和电击之间的那种反馈关系。此外，我们也可以考察一下无力感的内在结构。什么叫无力感的内在结构呢？就是说，无力感不是一个单一的感受，它背后有不同的因子。前面提到的预期是一个因子，如果一个人的预期很单一，觉得我这么做一定要得到这样的结果，那就容易产生无力感。同时，无力感不仅仅是因为一个人受挫，而是说，你觉得你受挫的那件事是唯一有价值的事情，这件事是要决定其他一切事情的。否则的话，当你失败的时候，你还可以愤怒、反思、另辟蹊径，无力感只不过是其中的一种可能。</p><p>这当然不是说无力感是个人的过错。但是如果我们要对生活、对社会负责，我们只能从我们能做的地方开始，而最能做的，就是从自己开始。也只有从自己开始，才有可能去发声、去行动，才有可能影响别人，并开始改变环境。</p><p>我当然会非常高兴和《当代青年研究》的读者继续交流。我们的研究取向（“共同的焦虑”）就是要提倡“共同的研究”，研究者和被研究者一起思考。对我来说，和读者的互动完全不是所谓发布研究结果，而是思考和研究过程本身。我特别想听到青年朋友们告诉我，你们觉得自己人生中的哪些问题值得讨论。<strong>人生的问题一定要结合人生的经验，一个想法是不是深刻、会不会有实际效果，在很大程度上取决于想法和具体经验的结合程度。</strong> 如果大家能够从对具体经验的反思开始，从这里提出有很切实的场景感的问题，会使我们的讨论更加有效。</p><h3 id="结语">结语</h3><p>对于访谈的价值，项飙（2020）说过：在访谈的时候不能用学术的语言，要用直白的语言来讲已经想得比较明白的话，这对于被访者是一个自我提高的过程；更重要的价值是互动，通过访谈能够跟现在的年轻群体交流，看到一些正在发生的变化，这个太重要了。同时项飙注意到，今天的年轻人在面对现实的困境时渴望获得一些思考的工具，他希望自己的工作能做这样的思考工具的孵化器。项飙的愿望可以说跟我们访谈的初衷不谋而合。青年研究需要去理解今天的年轻人跟当下的时代、跟眼前的社会之间的关系，而这种理解必须从年轻人非常具体的生存状态和个人经验出发，我们希望通过交流与互动，来促进这种理解，为青年的高质量发展提供智识上的帮助。</p> <section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>本文内容来自《当代青年研究》2023年11月第<a href="https://qing.cbpt.cnki.net/wkh/WebPublication/paperDigest.aspx?paperID=e4e7eee0-a359-4f9a-9496-612b13ac9ba8">5</a>、第<a href="https://qing.cbpt.cnki.net/wkh/WebPublication/paperDigest.aspx?paperID=7565cf64-374f-4372-a52e-1889a6ca3ac8">6</a>期。<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>摘录</category>
      
    </categories>
    
    
    <tags>
      
      <tag>社会观察</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>序</title>
    <link href="/%E5%BA%8F/"/>
    <url>/%E5%BA%8F/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>刘伶，字伯伦，沛国人也。 放情肆志，常以细宇宙齐万物为心。 澹默少言，不妄交游，与阮籍、嵇康相遇，欣然神解，携手入林。 初不以家产有无介意。 常乘鹿车，携一壶酒，使人荷锸而随之，谓曰：“死便埋我”。 ——选自《晋书·刘伶传》</p></blockquote><p>那年刘伶还在读书，从家里去往学校需要翻过一座山。冬末一次短暂的清晨暖阳，刘伶正沿一条泥泞小路往学校去，路旁的小树上接连悬挂几天的雪帽逐渐化成泪水，他预感到这片已经陪伴他十六年的土地正为他作长久的告别。洁白的雪总把路搞得肮脏不堪，一切看起来都那样混乱和死气沉沉。刘伶忽然想起去年冬日，尽管在室内是同样的死寂和刺骨的冷，可野外的暖阳却能让人尽情绽放生命，当时的他还可以跑起来，即使冷风刺骨，却毫无让他逾越冬日的念想。</p><p>冬日不久后就被逾越了，在元宵节那天，母亲为他整理第二天做新学业的书包，沉默的父亲依旧沉默。经过寒假长期的思索，他决定在今晚团圆夜将自己的想法公之于众。事实上他最终是偷偷溜走的，从此开始了一个人踽踽独行的生活。离开之前他在自己的房间里留下了这样一纸书：</p><h3 id="为我之新生">为我之新生</h3><blockquote><p>常常从你们的口中听说我是一个开朗活泼调皮的小孩，我似乎也能回想起曾经做过的那些真正融入自然的事情，我清楚自己可以徒手爬上树和屋顶看风景，可以在夜里院前吹着晚风携着对自然万物无知的敬畏与惶恐入睡，我曾不止一次与水之死神打交道，也不止一次捕捉青蛙诱钓小龙虾，我曾遇见竹叶青，在它的栖息地挖过笋，也曾见过一个深渊巨洞，它被枯叶完全覆盖，听说下面满是死尸。</p><p>然而，既是听闻，你们一定清楚它们都早已离我而去，当我逐渐从自然向人们走近，第一次认识十公里之外的人 ，我却有一种难以诉说的苦楚。三年来，我陷入沉闷和孤独，曾经轻松欢快的气氛难以重现。那些年，我的世界充满了欢笑与探索，如今却被沉重的孤独笼罩。每当夜深人静，我会想起那些在树梢上俯瞰的日子，心中泛起的自由感渐渐被现实的束缚所取代。人与人之间的距离让我感到无所适从，曾经的自然亲密无间，如今却被冷漠的面孔和复杂的关系所替代。</p><p>我开始渴望重拾与自然的联系，寻找那份失落的纯真。每次走出家门，耳边的风声和树叶的沙沙声似乎在召唤我，提醒我曾经的自己。昨夜不知是现实还是梦中（如您所见我的状态已经如此混乱），我忽然对此感到困惑，我在何时将自然之子的天然灵魂丢失了。也许如今我所经历的，是一个漫长而真实的梦，一个明知是梦却无法清醒的梦。记事以来许多的事情都使周围的一切变得那样不真实，我似乎并不亲历世间。</p><p>我决定远行，去探寻那些隐秘的角落，去追逐光影和回忆，或许可以在这条路上重塑灵魂，找到重新与世界连接的勇气。</p><p>亲爱的母亲，请不必担心我的学业，尽管我成绩优异，学堂的老师们都喜欢我，但我无法忽视内心的想念，学业并非我所想望的，这并非我之所求。我的生命不能浪费在任何我所不热爱的生活之中，如果您爱我，请将我还给自然。我向您保证，连带我的肉体和灵魂都将处于随时的安全之中，然而即使我在寻求的途中死去，您一定要理解：这是我重获新生的最终道路，您务必莫为此伤心。</p><p>纯然理性代表的父亲，您一定能理解您已经长大的孩子经过深思熟虑后所做出的这个决定，在它萌生之初我丝毫不愿瞻前顾后，这个决定始终未有改变，我想我应该坚持在这条道路上走下去。</p><p>我希望能够再次攀登那些熟悉的树木，在顶端感受那份久违的畅快与宁静。也许，在自然的怀抱中，我能找到解开心结的钥匙，重燃生命的热情。或许一切都可以改变，生活也能重新闪耀，而那些触目惊心的困惑也会在亲历之中得到消解。</p><p>一切顺利的话，我将在十八岁那年回来，请不必为我担忧，更不必试图寻找我的踪迹，请尽情让我为自然冒险。</p><p>刘伶</p></blockquote><p>那夜，刘伶沿窗从二楼向屋外的草地纵身一跃，他身无分文，背着行李便好无畏地朝北方道路大步向前走，心中思虑：今后的日子里，或许只有几本书相伴了，以后是以后，今夜过后我将迎来十七岁了，金色年纪的我能否将那被称作“世界”或“生命”的事物看得更清晰一些呢？</p>]]></content>
    
    
    <categories>
      
      <category>小说</category>
      
    </categories>
    
    
    <tags>
      
      <tag>死便埋我</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>落选感言与陋作</title>
    <link href="/%E8%90%BD%E9%80%89%E6%84%9F%E8%A8%80%E4%B8%8E%E9%99%8B%E4%BD%9C/"/>
    <url>/%E8%90%BD%E9%80%89%E6%84%9F%E8%A8%80%E4%B8%8E%E9%99%8B%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>2023年12月31日晚，「多抓鱼文学奖」投稿时间步入倒计时。在经历了两个星期的遴选，最终确定，我的伟大创作终于落选。踌躇之余，我写下了这篇落选感言，没有人能剥夺我发表感言的权利！</p><p>这是一段「不论你看不看，我始终要写」的落选感言，其中我共有三句话要说：</p><p>第〇句话是，此次「多抓鱼文学奖」的征稿主题是「从庆祝失败开始」。</p><p>第一句话是，原本想写的是获奖感言。然而我被骗了。多抓鱼的鱼编在向我们宣布这场文学奖开幕时，真诚竟流于字里行间，让我奋不顾身地投了稿，以至于我忽视了自己是如此的业余且不自量力。</p><p>第二句话是，直到多抓鱼文学奖入围作品公布后，我望着自己的创作暗自内省时，才惊觉此次多抓鱼文学奖选题是如此的绝妙。回忆起创作过程中对于所谓失败的那些老土的批判，在经历了落选后才真正刻骨铭心。落选不过是一种仅对「我」产生影响的结局，而我对此并不在意。我在意的是，在投稿的那一刻，我是如此的兴奋。于是在那一晚，我便提前从庆祝开始了。感谢多抓鱼让快要发烂的我一度进入了心流，在以前，这种状态似乎只偶尔出现在做数学题时。</p><p>第三句话是，即便它被称为「失败」的作品，我依然要向你分享它。征稿主题中去掉最讨厌的一个词便是它的标题：「从庆祝开始」。愿意的话，欢迎你浪费自己宝贵的亲历世间的时间在这样一篇陋作上；不愿意的话，我仍有强制的——像这篇落选感言一样——要赠予你的东西。在创作结尾，我引入了一段歌词，它来自台湾乐队「浅堤」：「日子轻如叶，生命如卷风，从落地那刻起本来就值得祝福！」。</p><h3 id="从庆祝开始">从庆祝开始</h3><p>这是个物欲横流的时代，这是处颇具文明的地界。世间多忙碌，人人皆利己。</p><p>我曾诧异且惊恐，究竟是从何时开始，我竟全然失去了纯良。那种强制让人有其荣辱感、善恶观和是非念的事物，最终酿造了我时刻存在的警惕、防范和怀疑。亲爱的朋友，不要不明所以，促成这样的结果，其原因在于你我。我们总能找到历历在目的实例，比如一个难以言状的眼神、一切出于礼貌的保持距离、一抹蒙娜丽莎般的笑容或一张平静的面庞。不论你主动或被动、有意或无意、善意或恶意，旁观者自有其判断，判断并对结论暗自肯定，于是误解与偏见便产生。</p><p>荣辱感就是这样在生活中发挥作用的，它告诉人们要追求成功，远离失败。于是有了是非念：成功便是对的，失败便是错的。当然，到了今天，我们大概都会对此言论嗤之以鼻，但这并不妨碍我们继续崇尚成功，避免失败。</p><p>这误解与偏见似乎也惹得怀疑了。比如，也许你曾听见有人说，失败没什么可怕的，不妨换个角度看待它。失败只是意味着自己的实力（有人宣称运气也是一种实力）暂时还没有达到能够完成某件事的水平，倘从中获益，将其看作是一次吸取经验或是教训的磨练与成长，便算不得失败。仔细一想，倒也算得上是另一种成功，成功于为下一次的成功扫除了一些障碍，所以失败其实是成功的开始，庆祝失败，就是在庆祝自己正走向通往成功的道路上。这言论接近精妙，让读者热血澎湃，你我似乎马上就要埋头为求成功辛勤奋斗去了。而脱口而出之安慰者是如此的暖心、励志且老到！</p><p>我的朋友，你仔细想一想，这算不算得上是一种逃避？逃避在于不敢承认自己确是失败，怕因此打击内心，挫败沮丧，惹了心烦，随即自信全无，害怕往后做事要瞻前顾后，不敢再拼力付出。逃避在于将失败全然归咎于自己对事物的认知出现错误，认为是由于自己没有“正确”看待成功与失败，所以才失败了。</p><p>你也许反驳道：不会如此！毕竟是胸怀宏图，懂得坚忍不拔，即使撞得头破血流，只要无愧于心，便是无论如何不畏惧地要撞开南墙；同时也懂得柳暗花明，不会囿于眼前的小麻烦而停滞不前。你可知漫漫长路，“塞翁失马”慰藉了黑夜里多少受伤心灵！</p><p>的确，朋友，你是如此的立大事者。但在我提出我的观点之前，请允许我阐明来自狂妄之我的一些见解。某种意义上，包括你我在内的所有人，做任何事情，不过都是为一己之欲所趋。人人皆是“利己主义者”。即便是至善至美之人，其内心确是纯良，也许十分利他，但终究是利于自己内心对纯良的欲望。（此处之“欲”无关道德，只指人的内心真切想要做的，下同；此处之“利己”指广义上的利于己之欲，下同）。对此，只消举出一例。古今多少志士以“自我牺牲”名垂青史，他们所做似乎都是为了保一方平安，可谁又懂得他们赴死前内心是否有过挣扎？最终牺牲者，或是迈着不要命的步伐慷慨就义，这部分人之内心全然有一声音，告诉自己这就是我想要做的事业，这何尝不是一种“利己”？利于自己的欲望。另有一部分人（请饶恕我对此妄加揣测），他们的求生欲或胜过赴死欲，他们并不希望就此失去宝贵生命，但由于生命脆弱、战争无情，或是人性叵测、苍天无心，终究成为牺牲者。我们当然不应该以此认为他们不能享有“无畏的牺牲者”之誉。也许你发问，赴死欲（这样称呼实在怪异）不还是为了“保一方平安”吗？怎么就是利己了？可“保一方平安”又是为什么呢？其根本，不也是源自内心对人的宏伟大爱吗？这爱何尝不是“己之欲”的事？而如我之俗人，更不必言说，狭义的利己主义就足够使我现出原形。</p><p>要谈论失败，注定就要谈论成功。成功之结果的最大特点就是利己，又因人人皆是利己者，所以人人皆为自己的成功（全然是自己的成功！）而奔波确是理所当然的。失败何尝不是一种利己？失败带给人自省与经验，是以满足求知欲，却怎么很难让人高兴起来，很难让人为之庆祝呢？难道利己的事情不该为之高兴吗？究其原因，失败的损己大于利己罢了。成功带给我们的满足感、虚荣心（毫无批判之意）会让我们十分喜悦，我们会因此认为成功是值得我们去做的事情。而失败却意味着自己之前所花费的一切努力付之一炬了，其中最珍贵的时间也因此流逝了，于是失败后便陷入了无限的自责：如果我再努力一些，是不是结果就不一样了？失败，且不说是否意味着自身能力不足，我本按势必成功的姿态去努力拼搏，背后所花费的时间与精力，岂又是单单这些经验能够弥补的？</p><p>朋友，这难道不是快要陷入了那要命的成功学与结果论的圈套吗！而那些关于“失败是另一种成功”的种种言论，它们又是何等的冠冕堂皇！他们声称失败比成功更重要，而其理由之指向，用鲁迅之笔写出来则是：磕磕绊绊每句话都念着成长磨练四个字，我横竖睡不着，仔细想了半夜，才从话缝中听出来，满口都说着的两个字是成功！。又何必费此周章，想着要给失败的人一些慰藉。倘若失败真的比成功重要，那我还要成功作甚？便一直失败就好了。按他们的话语，我一直的失败不正是为了成功吗？那我到底是应该去成功还是应该去失败？阴谋论地讲，有些人，或许就盼望着你我如此的“一直失败”，那些随处可见的糟糕透顶的励志鸡汤，可真是要命！而你我如此努力，不知无形中带给他们多少好处。</p><p>迄今我们所谈论的所有关于失败的言论，似乎都对失败的内因避而不谈。事实上，对一件事情倾心多少自己懂得，这件事本身无话可谈，我也不愿讲出励志的言论以劝诫朋友们去努力拼搏，毕竟我自己对此也是如一地鸡毛般。我此前所讨论的失败只是建立在一般情况下确切认真努力过后的失败，私以为，除特别伟大的成功或失败外的许多问题其实我们都能够妥善解决，它们还没有到那种非得动用天赋的地步。即使关于天赋，不论你是否注意到它，它始终都在那。</p><p>可这往往引出了一个亟待解决的问题，失败也许会使我们陷入无限对比与埋怨不公的泥沼之中，愈发地挣扎想要证明自己，陷入愈深。从成为学生的第一天起，大人们只告诉我们该努力，却不告诉我们该如何努力，这难道不是只追求成功这一结果，却对过程避而不谈吗？继而便是产生怀疑：我怎么知道自己的努力是不是正确的？我们当然明白，成功背后是多少次努力的失败，可失败背后难道就不是努力的失败吗？如果我一辈子如此努力却始终失败是否说明走错了路？</p><p>朋友，你是否惊觉，我们又陷入了是非念。是否是正确的道路有那么重要吗？难道你所作的事情不是为你自己吗？问心无愧难道不才是最重要的吗？</p><p>因此，有一件更为重要的问题：即便如此，我们不过也是在追求成功的道路上。不论是执拗于对比、流于埋怨不公中，还是认为失败比成功更重要、失败是对自身能力的否定，亦或对前路无休止的猜疑，其最终目的都是奔向成功而去。可我们一定要如此吗？是否存在着失败后的成功或失败后的失败外的第三条路呢？</p><p>我想，古人早就给出了答案。子曰：“……随心所欲不逾矩。”这件事情说出来总是十分轻巧。记得我曾反思：我总认为自己在跟随内心。也许我的确在这么做，只是同样受到了社会环境的影响，那种强制让人有其荣辱感、善恶观、是非念的事物让我感到厌恶，这是不是说明自己并没有真正的跟随内心？如今我可以给出答案了：只要生活在这个世界上，便是在所难免需要承受这些，无一幸免。而跟随内心，并非指舍身忘死地听从内心，而是在现实的压力下我们两相权衡，做出自己理性与感性的选择。</p><p>我们所追求的许多成功，是否都是遵从内心的呢？</p><p>例如许多为之努力的最终都变成了为钱财计、为权力计的事情。恕我冒昧，私以为，至少在中国，大概已没有那种需要为谋基础生计（简单的吃穿住）付出令人刻骨铭心的辛劳的人。我竟如此困惑，世间路本千千万，何以人人皆接踵于钱权这一扇门？我相信，对于世上大多数人，比之钱权，他们一定有更加根本的想要追求的东西，只是这一切似乎都需要一个契机，或需自己寻找。心底深处那不曾被点亮的一颗无名星，一旦被发现，便会发出强热，成为内心的太阳，久久燃烧。</p><p>对于成功，不该是人云亦云。成功应该是“我云”之事，或者说，我所要做的事情，无关成与败。仔细听从内心吧，那神秘声音不正告诉我们答案在哪里吗？世上许多抉择，无论何等结局，只要是认真地活，皆为平等，作为旁观者，不必以轻蔑之姿、傲慢之态去批判，亦不必赞扬，不必怜悯与同情。当然前提在于安分地生活，需要热烈，但至少应该守“矩”，“矩”即内心之法，其前提在于良知。从“我”之成功开始，失败便也只是一种仅对我产生影响的结局了，而我对此并不在意。我在意的是，在努力生活的路上，亲历这真实的世界。因为我将不再受他人之影响，而是作为“利己主义者”，听从内心的安排，全然认真生活，并爱它。</p><p>来自台湾高雄的乐队浅堤有一首名为「礼物」的歌，其中有一段歌词，现抄录作为本文结尾赠予阅读至此的我所爱的朋友们：</p><blockquote><p>日子轻如叶，生命如卷风，从落地那刻起本来就值得祝福。</p></blockquote><p>所以，一切从庆祝开始吧！——庆祝什么？——管它呢！</p>]]></content>
    
    
    <categories>
      
      <category>随笔</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>单向历</title>
    <link href="/%E5%8D%95%E5%90%91%E5%8E%86/"/>
    <url>/%E5%8D%95%E5%90%91%E5%8E%86/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>每日揭开新的一页，如同生活在妙不可言的等待中，等待随便哪种未来</p><p><img src="https://calendar.nhwite.cn" alt></p>]]></content>
    
    
    
    <tags>
      
      <tag>今天做什么</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
